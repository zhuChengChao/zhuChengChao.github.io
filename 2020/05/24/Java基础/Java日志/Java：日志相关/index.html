<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/Mario.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/Mario.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="学习一波Java中日志相关的技术，本文是根据bilibili上 黑马程序员 的课程 Java日志框架教程 而做的个人学习笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="Java：日志相关">
<meta property="og:url" content="http://example.com/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/index.html">
<meta property="og:site_name" content="贤余超">
<meta property="og:description" content="学习一波Java中日志相关的技术，本文是根据bilibili上 黑马程序员 的课程 Java日志框架教程 而做的个人学习笔记">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/JUL架构介绍.PNG">
<meta property="og:image" content="http://example.com/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/日志原理解析.PNG">
<meta property="og:image" content="http://example.com/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/log4j.PNG">
<meta property="og:image" content="http://example.com/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/JCL.PNG">
<meta property="og:image" content="http://example.com/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/jcl实现原理.PNG">
<meta property="og:image" content="http://example.com/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/日志门面和日志实现的关系.PNG">
<meta property="og:image" content="http://example.com/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/slf4j绑定日志.PNG">
<meta property="og:image" content="http://example.com/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/slf桥接旧的日志框架.PNG">
<meta property="og:image" content="http://example.com/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/log4j2同步日志.PNG">
<meta property="og:image" content="http://example.com/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/log4j2异步日志.PNG">
<meta property="og:image" content="http://example.com/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/log4j2性能.PNG">
<meta property="og:image" content="http://example.com/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/log4j2分配1.PNG">
<meta property="og:image" content="http://example.com/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/log4j2分配2.PNG">
<meta property="og:image" content="http://example.com/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/springboot依赖关系图.PNG">
<meta property="article:published_time" content="2020-05-24T02:24:00.000Z">
<meta property="article:modified_time" content="2020-05-24T02:24:00.000Z">
<meta property="article:author" content="ZhuCC">
<meta property="article:tag" content="学习笔记">
<meta property="article:tag" content="Java基础">
<meta property="article:tag" content="日志框架">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/JUL架构介绍.PNG">

<link rel="canonical" href="http://example.com/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Java：日志相关 | 贤余超</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>
	<a target="_blank" rel="noopener" href="https://github.com/zhuChengChao" class="github-corner" aria-label="View source on GitHub">
	<svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true">
	<path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
	<path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
	<path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
	</svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">贤余超</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">一位底层码农 :-)</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">96</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">18</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">203</span></a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/%E5%A4%B4%E5%83%8F.jpg">
      <meta itemprop="name" content="ZhuCC">
      <meta itemprop="description" content="不急不躁。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="贤余超">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Java：日志相关
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-05-24 10:24:00" itemprop="dateCreated datePublished" datetime="2020-05-24T10:24:00+08:00">2020-05-24</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java%E5%9F%BA%E7%A1%80/" itemprop="url" rel="index"><span itemprop="name">Java基础</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>47k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>43 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>学习一波Java中日志相关的技术，本文是根据bilibili上 <a target="_blank" rel="noopener" href="https://space.bilibili.com/37974444">黑马程序员</a> 的课程 <a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1iJ411H74S?spm_id_from=333.999.0.0">Java日志框架教程</a> 而做的个人学习笔记</p>
<span id="more"></span>
<h1 id="java日志相关">Java：日志相关</h1>
<h2 id="日志的概念">1. 日志的概念</h2>
<h3 id="日志文件">1.1 日志文件</h3>
<p><strong>日志文件是用于记录系统操作事件的文件集合</strong>，可分为事件日志和消息日志。具有处理历史数据、诊断问题的追踪以及理解系统的活动等重要作用。</p>
<p>在计算机中，日志文件是记录在操作系统或其他软件运行中发生的事件，或在通信软件的不同用户之间的消息的文件。记录是保持日志的行为。在最简单的情况下，消息被写入单个日志文件。</p>
<p>许多操作系统，软件框架和程序包括日志系统。广泛使用的日志记录标准是在因特网工程任务组(IETF)RFC5424中定义的syslog。 syslog标准使专用的标准化子系统能够生成，过滤，记录和分析日志消息。</p>
<h4 id="调试日志">1.1.1 调试日志</h4>
<p>软件开发中，经常需要去调试程序，做一些信息，状态的输出便于查询程序的运行状况。为了能够更加灵活和方便的控制这些调试的信息，所以需要专业的日志技术。java中寻找bug会需要重现。调试也就是debug可以在程序运行中暂停程序运行，查看程序在运行中的情况。日志主要是为了更方便的去重现问题。</p>
<h4 id="系统日志">1.1.2 系统日志</h4>
<p>系统日志是记录系统中硬件、软件和系统问题的信息，同时还可以监视系统中发生的事件。用户可以通过它来检查错误发生的原因，或者寻找受到攻击时攻击者留下的痕迹。系统日志包括系统日志、应用程序日志和安全日志。</p>
<p><strong>系统日志的价值</strong>：系统日志策略可以在故障刚刚发生时就向你发送警告信息，系统日志帮助你在最短的时间内发现问题。</p>
<p>系统日志是一种非常关键的组件，因为系统日志可以让你充分了解自己的环境。这种系统日志信息对于决定故障的根本原因或者缩小系统攻击范围来说是非常关键的，因为系统日志可以让你了解故障或者袭击发生之前的所有事件。为虚拟化环境制定一套良好的系统日志策略也是至关重要的，因为系统日志需要和许多不同的外部组件进行关联。良好的系统日志可以防止你从错误的角度分析问题，避免浪费宝贵的排错时间。另外一种原因是借助于系统日志，管理员很有可能会发现一些之前从未意识到的问题，在几乎所有刚刚部署系统日志的环境当中。</p>
<h2 id="java日志框架">2. JAVA日志框架</h2>
<p><strong>问题</strong>：</p>
<ol type="1">
<li>控制日志输出的内容和格式</li>
<li>控制日志输出的位置</li>
<li>日志优化：异步日志，日志文件的归档和压缩</li>
<li>日志系统的维护</li>
<li>面向接口开发：日志的门面</li>
</ol>
<h3 id="使用日志框架原因">2.1 使用日志框架原因</h3>
<p>软件系统发展到今天已经很复杂了，特别是服务器端软件，涉及到的知识，内容，问题太多。在某些方面使用别人成熟的框架，就相当于让别人帮你完成一些基础工作，你只需要集中精力完成系统的业务逻辑设计。而且框架一般是成熟，稳健的，他可以处理系统很多细节问题，比如，事务处理，安全性，数据流控制等问题。还有框架一般都经过很多人使用，所以结构很好，所以扩展性也很好，而且它是不断升级的，你可以直接享受别人升级代码带来的好处。</p>
<h3 id="现有的日志框架">2.2 现有的日志框架</h3>
<p>JUL（java util logging）、logback、log4j、log4j2</p>
<p>JCL（Jakarta Commons Logging）、slf4j（ Simple Logging Facade for Java）</p>
<p><strong>日志门面：</strong>JCL、slf4j</p>
<p><strong>日志实现：</strong>JUL、logback、log4j、log4j2</p>
<h2 id="jul-学习">3. JUL 学习</h2>
<p>JUL全称Java util logging是java原生的日志框架，使用时不需要另外引用第三方类库，相对其他日志框架使用方便，学习简单，能够在小型应用中灵活使用。</p>
<h3 id="jul入门">3.1 JUL入门</h3>
<h4 id="架构介绍">3.1.1 架构介绍</h4>
<p><img src="/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/JUL架构介绍.PNG" alt="JUL架构介绍"></p>
<ul>
<li>Loggers：被称为记录器，应用程序通过获取Logger对象，调用其API来来发布日志信息。Logger通常是应用程序访问日志系统的入口程序。</li>
<li>Appenders：也被称为Handlers，每个Logger都会关联一组Handlers，Logger会将日志交给关联Handlers处理，由Handlers负责将日志做记录。Handlers在此是一个抽象，其具体的实现决定了日志记录的位置可以是控制台、文件、网络上的其他日志服务或操作系统日志等。</li>
<li>Layouts：也被称为Formatters，它负责对日志事件中的数据进行转换和格式化。Layouts决定了数据在一条日志记录中的最终形式。</li>
<li>Level：每条日志消息都有一个关联的日志级别。该级别粗略指导了日志消息的重要性和紧迫，可以将Level和Loggers，Appenders做关联以便于过滤消息。</li>
<li>Filters：过滤器，根据需要定制哪些信息会被记录，哪些信息会被放过。</li>
</ul>
<p><strong>总结一下就是：</strong>用户使用Logger来进行日志记录，Logger持有若干个Handler，日志的输出操作是由Handler完成的。在Handler在输出日志前，会经过Filter的过滤，判断哪些日志级别过滤放行哪些拦截，Handler会将日志内容输出到指定位置（日志文件、控制台等）。Handler在输出日志时会使用Layout，将输出内容进行排版。 （结合 <code>test03</code> 理解）</p>
<h4 id="入门案例">3.1.2 入门案例</h4>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 此时采用的是这个包</span></span><br><span class="line"><span class="keyword">import</span> java.util.logging.*;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1.创建日志记录器对象</span></span><br><span class="line">    Logger logger = Logger.getLogger(<span class="string">&quot;cn.xyc.JULTest&quot;</span>);</span><br><span class="line">    <span class="comment">// 2.1日志记录输出</span></span><br><span class="line">    logger.info(<span class="string">&quot;hello jul&quot;</span>);</span><br><span class="line">    <span class="comment">// 2.2通用方法进行日志记录</span></span><br><span class="line">    logger.log(Level.INFO, <span class="string">&quot;info msg&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2.3通过占位符方式进行日志的记录</span></span><br><span class="line">    String name = <span class="string">&quot;jack&quot;</span>;</span><br><span class="line">    Integer age = <span class="number">18</span>;</span><br><span class="line">    logger.log(Level.INFO, <span class="string">&quot;用户信息：&#123;0&#125;, &#123;1&#125;&quot;</span>, <span class="keyword">new</span> Object[]&#123;name, age&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="日志的级别">3.2 日志的级别</h3>
<p>jul中定义的日志级别</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">*</span> java.util.logging.Level中定义了日志的级别：</span><br><span class="line"><span class="code">    SEVERE（最高值）</span></span><br><span class="line"><span class="code">    WARNING</span></span><br><span class="line"><span class="code">    INFO （默认级别）</span></span><br><span class="line"><span class="code">    CONFIG</span></span><br><span class="line"><span class="code">    FINE</span></span><br><span class="line"><span class="code">    FINER</span></span><br><span class="line"><span class="code">    FINEST（最低值）</span></span><br><span class="line"><span class="code">* 还有两个特殊的级别：</span></span><br><span class="line"><span class="code">    OFF，可用来关闭日志记录。</span></span><br><span class="line"><span class="code">    ALL，启用所有消息的日志记录。</span></span><br></pre></td></tr></table></figure>
<p>虽然这里测试了7个日志级别，但是默认值能输出info以上的级别</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test02</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">    <span class="comment">// 1.创建日志记录器对象</span></span><br><span class="line">    Logger logger = Logger.getLogger(<span class="string">&quot;cn.xyc.JULTest&quot;</span>);</span><br><span class="line">    <span class="comment">// 2.1日志记录输出</span></span><br><span class="line">    logger.severe(<span class="string">&quot;severe&quot;</span>);</span><br><span class="line">    logger.warning(<span class="string">&quot;warning&quot;</span>);</span><br><span class="line">    logger.info(<span class="string">&quot;info&quot;</span>);</span><br><span class="line">    logger.config(<span class="string">&quot;config&quot;</span>);  <span class="comment">// 后面的内容就不再输出了</span></span><br><span class="line">    logger.fine(<span class="string">&quot;fine&quot;</span>);</span><br><span class="line">    logger.finer(<span class="string">&quot;finer&quot;</span>);</span><br><span class="line">    logger.finest(<span class="string">&quot;finest&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>自定义日志级别配置</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test03</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1.创建日志记录器对象</span></span><br><span class="line">    Logger logger = Logger.getLogger(<span class="string">&quot;cn.xyc.JULTest&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2.自定义日志级别</span></span><br><span class="line">    <span class="comment">// a.关闭系统默认配置</span></span><br><span class="line">    logger.setUseParentHandlers(<span class="keyword">false</span>);</span><br><span class="line">    <span class="comment">// b.创建handlerd对象</span></span><br><span class="line">    ConsoleHandler consoleHandler = <span class="keyword">new</span> ConsoleHandler();</span><br><span class="line">    <span class="comment">// c.创建formatter对象</span></span><br><span class="line">    SimpleFormatter simpleFormatter = <span class="keyword">new</span> SimpleFormatter();</span><br><span class="line">    <span class="comment">// d.进行关联</span></span><br><span class="line">    consoleHandler.setFormatter(simpleFormatter);</span><br><span class="line">    logger.addHandler(consoleHandler);</span><br><span class="line">    <span class="comment">// e.进行日志级别设置</span></span><br><span class="line">    logger.setLevel(Level.ALL);</span><br><span class="line">    consoleHandler.setLevel(Level.ALL);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 3. 输出日志到文件</span></span><br><span class="line">    FileHandler fileHandler = <span class="keyword">new</span> FileHandler(<span class="string">&quot;./logs/jul.log&quot;</span>);</span><br><span class="line">    fileHandler.setFormatter(simpleFormatter);</span><br><span class="line">    logger.addHandler(fileHandler);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4. 日志记录输出——控制台中设置了all因此全部输出  而文件handler为默认值只输出到info结束</span></span><br><span class="line">    logger.severe(<span class="string">&quot;severe&quot;</span>);</span><br><span class="line">    logger.warning(<span class="string">&quot;warning&quot;</span>);</span><br><span class="line">    logger.info(<span class="string">&quot;info&quot;</span>);</span><br><span class="line">    logger.config(<span class="string">&quot;config&quot;</span>);</span><br><span class="line">    logger.fine(<span class="string">&quot;fine&quot;</span>);</span><br><span class="line">    logger.finer(<span class="string">&quot;finer&quot;</span>);</span><br><span class="line">    logger.finest(<span class="string">&quot;finest&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出结果：</span></span><br><span class="line"><span class="comment">//   控制台：</span></span><br><span class="line"><span class="comment">//     八月 25, 2020 8:35:59 下午 cn.xyc.Test01 test01</span></span><br><span class="line"><span class="comment">//     严重: severe</span></span><br><span class="line"><span class="comment">//     八月 25, 2020 8:35:59 下午 cn.xyc.Test01 test01</span></span><br><span class="line"><span class="comment">//     警告: warning</span></span><br><span class="line"><span class="comment">//     八月 25, 2020 8:35:59 下午 cn.xyc.Test01 test01</span></span><br><span class="line"><span class="comment">//     信息: info</span></span><br><span class="line"><span class="comment">//     八月 25, 2020 8:35:59 下午 cn.xyc.Test01 test01</span></span><br><span class="line"><span class="comment">//     配置: config</span></span><br><span class="line"><span class="comment">//     八月 25, 2020 8:35:59 下午 cn.xyc.Test01 test01</span></span><br><span class="line"><span class="comment">//     详细: fine</span></span><br><span class="line"><span class="comment">//     八月 25, 2020 8:35:59 下午 cn.xyc.Test01 test01</span></span><br><span class="line"><span class="comment">//     较详细: finer</span></span><br><span class="line"><span class="comment">//     八月 25, 2020 8:35:59 下午 cn.xyc.Test01 test01</span></span><br><span class="line"><span class="comment">//     非常详细: finest</span></span><br><span class="line"><span class="comment">//   文件中：</span></span><br><span class="line"><span class="comment">//     输出的内容和控制台一样？？？  为什么？？？</span></span><br></pre></td></tr></table></figure>
<h3 id="logger之间的父子关系">3.3 Logger之间的父子关系</h3>
<p>JUL中Logger之间存在父子关系，这种父子关系通过树状结构存储，JUL在初始化时会创建一个顶层RootLogger作为所有Logger父Logger，存储上作为树状结构的根节点。并且父子关系通过路径来关联。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test04</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 日志记录器对象父子关系</span></span><br><span class="line">    Logger logger1 = Logger.getLogger(<span class="string">&quot;com.xyc.log&quot;</span>);</span><br><span class="line">    Logger logger2 = Logger.getLogger(<span class="string">&quot;com.xyc&quot;</span>);</span><br><span class="line">    System.out.println(logger1.getParent() == logger2);  <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 所有日志记录器对象的顶级父元素class为</span></span><br><span class="line">    <span class="comment">// java.util.logging.LogManager$RootLogger name为&quot;&quot;</span></span><br><span class="line">    System.out.println(<span class="string">&quot;logger2 parent:&quot;</span> + logger2.getParent() + <span class="string">&quot;, name:&quot;</span> + logger2.getParent().getName());</span><br><span class="line">    <span class="comment">// logger2 parent:java.util.logging.LogManager$RootLogger@4f2410ac, name:</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 一、自定义日志级别</span></span><br><span class="line">    <span class="comment">// a.关闭系统默认配置</span></span><br><span class="line">    logger2.setUseParentHandlers(<span class="keyword">false</span>);</span><br><span class="line">    <span class="comment">// b.创建handler对象</span></span><br><span class="line">    ConsoleHandler consoleHandler = <span class="keyword">new</span> ConsoleHandler();</span><br><span class="line">    <span class="comment">// c.创建formatter对象</span></span><br><span class="line">    SimpleFormatter simpleFormatter = <span class="keyword">new</span> SimpleFormatter();</span><br><span class="line">    <span class="comment">// d.进行关联</span></span><br><span class="line">    consoleHandler.setFormatter(simpleFormatter);</span><br><span class="line">    logger2.addHandler(consoleHandler);</span><br><span class="line">    <span class="comment">// e.设置日志级别</span></span><br><span class="line">    logger2.setLevel(Level.ALL);</span><br><span class="line">    consoleHandler.setLevel(Level.ALL);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 测试日志记录器对象父子关系——全部都输出</span></span><br><span class="line">    logger1.severe(<span class="string">&quot;severe&quot;</span>);</span><br><span class="line">    logger1.warning(<span class="string">&quot;warning&quot;</span>);</span><br><span class="line">    logger1.info(<span class="string">&quot;info&quot;</span>);</span><br><span class="line">    logger1.config(<span class="string">&quot;config&quot;</span>);</span><br><span class="line">    logger1.fine(<span class="string">&quot;fine&quot;</span>);</span><br><span class="line">    logger1.finer(<span class="string">&quot;finer&quot;</span>);</span><br><span class="line">    logger1.finest(<span class="string">&quot;finest&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="日志的配置文件">3.4 日志的配置文件</h3>
<p>默认配置文件路径<code>$JAVA_HOME\jre\lib\logging.properties</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test05</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 读取自定义配置文件</span></span><br><span class="line">    InputStream logging = JULTest.class.getClassLoader().getResourceAsStream(<span class="string">&quot;logging.properties&quot;</span>);</span><br><span class="line">    <span class="comment">// 获取日志管理器对象</span></span><br><span class="line">    LogManager logManager = LogManager.getLogManager();</span><br><span class="line">    <span class="comment">// 通过日志管理器加载配置文件</span></span><br><span class="line">    logManager.readConfiguration(logging);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用了自定义的Logger 输出等级为config因此能输出到config等级的日志</span></span><br><span class="line">    Logger logger1 = Logger.getLogger(<span class="string">&quot;com.xyc.log&quot;</span>);</span><br><span class="line">    logger1.severe(<span class="string">&quot;severe_xyc&quot;</span>);</span><br><span class="line">    logger1.warning(<span class="string">&quot;warning_xyc&quot;</span>);</span><br><span class="line">    logger1.info(<span class="string">&quot;info_xyc&quot;</span>);</span><br><span class="line">    logger1.config(<span class="string">&quot;config_xyc&quot;</span>);</span><br><span class="line">    logger1.fine(<span class="string">&quot;fine_xyc&quot;</span>);</span><br><span class="line">    logger1.finer(<span class="string">&quot;finer_xyc&quot;</span>);</span><br><span class="line">    logger1.finest(<span class="string">&quot;finest_xyc&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用了系统的Logger 输出等级为all 因此全部都能输出</span></span><br><span class="line">    Logger logger2 = Logger.getLogger(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">    logger2.severe(<span class="string">&quot;severe&quot;</span>);</span><br><span class="line">    logger2.warning(<span class="string">&quot;warning&quot;</span>);</span><br><span class="line">    logger2.info(<span class="string">&quot;info&quot;</span>);</span><br><span class="line">    logger2.config(<span class="string">&quot;config&quot;</span>);</span><br><span class="line">    logger2.fine(<span class="string">&quot;fine&quot;</span>);</span><br><span class="line">    logger2.finer(<span class="string">&quot;finer&quot;</span>);</span><br><span class="line">    logger2.finest(<span class="string">&quot;finest&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>配置文件：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## RootLogger使用的处理器（获取时设置）</span></span><br><span class="line"><span class="comment"># 设置RootLogger顶级父元素指定的默认处理器为ConsoleHandler</span></span><br><span class="line"><span class="comment"># handlers= java.util.logging.ConsoleHandler</span></span><br><span class="line"><span class="comment"># 对ConsoleHandler+FileHandler进行配置,即采用了两个默认的处理器</span></span><br><span class="line"><span class="attr">handlers</span>= <span class="string">java.util.logging.ConsoleHandler, java.util.logging.FileHandler</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># RootLogger顶级父元素默认的日志等级</span></span><br><span class="line"><span class="meta">.level</span>= <span class="string">ALL</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 自定义logging的使用</span></span><br><span class="line"><span class="meta">cn.xyc.handlers</span> = <span class="string">java.util.logging.ConsoleHandler</span></span><br><span class="line"><span class="meta">cn.xyc.level</span> = <span class="string">CONFIG</span></span><br><span class="line"><span class="comment"># 关闭默认配置</span></span><br><span class="line"><span class="meta">cn.xyc.useParentHandlers</span> = <span class="string">false</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">## 控制台处理器</span></span><br><span class="line"><span class="comment"># 输出日志级别</span></span><br><span class="line"><span class="meta">java.util.logging.ConsoleHandler.level</span> = <span class="string">ALL</span></span><br><span class="line"><span class="comment"># 输出日志格式</span></span><br><span class="line"><span class="meta">java.util.logging.ConsoleHandler.formatter</span> = <span class="string">java.util.logging.SimpleFormatter</span></span><br><span class="line"><span class="comment"># 指定字符集</span></span><br><span class="line"><span class="meta">java.util.logging.ConsoleHandler.encoding</span> = <span class="string">UTF-8</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">## 文件处理器</span></span><br><span class="line"><span class="comment"># 输出日志级别</span></span><br><span class="line"><span class="meta">java.util.logging.FileHandler.level</span>=<span class="string">INFO</span></span><br><span class="line"><span class="comment"># 输出日志格式</span></span><br><span class="line"><span class="meta">java.util.logging.FileHandler.formatter</span> = <span class="string">java.util.logging.XMLFormatter</span></span><br><span class="line"><span class="comment"># 输出日志文件路径</span></span><br><span class="line"><span class="meta">java.util.logging.FileHandler.pattern</span> = <span class="string">./logs/java%u.log</span></span><br><span class="line"><span class="comment"># 输出日志文件限制大小（50000字节）</span></span><br><span class="line"><span class="meta">java.util.logging.FileHandler.limit</span> = <span class="string">50000</span></span><br><span class="line"><span class="comment"># 输出日志文件限制个数</span></span><br><span class="line"><span class="meta">java.util.logging.FileHandler.count</span> = <span class="string">10</span></span><br><span class="line"><span class="comment"># 输出日志文件 是否是追加</span></span><br><span class="line"><span class="meta">java.util.logging.FileHandler.append</span>=<span class="string">true</span></span><br></pre></td></tr></table></figure>
<h3 id="日志原理解析">3.5 日志原理解析</h3>
<ol type="1">
<li>初始化LogManager
<ol type="1">
<li>LogManager加载logging.properties配置</li>
<li>添加Logger到LogManager</li>
</ol></li>
<li>从单例LogManager获取Logger</li>
<li>设置级别Level，并指定日志记录LogRecord</li>
<li>Filter提供了日志级别之外更细粒度的控制</li>
<li>Handler是用来处理日志输出位置</li>
<li>Formatter是用来格式化LogRecord的</li>
</ol>
<p><img src="/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/日志原理解析.PNG" alt="日志原理解析"></p>
<h2 id="log4j-学习">4. LOG4J 学习</h2>
<p>Log4j是Apache下的一款开源的日志框架，通过在项目中使用 Log4J，可以控制日志信息输出到控制台、文件、甚至是数据库中。可以控制每一条日志的输出格式，通过定义日志的输出级别，可以更灵活的控制日志的输出过程。方便项目的调试。</p>
<p>官方网站： http://logging.apache.org/log4j/1.2/</p>
<h3 id="log4j入门">4.1 Log4j入门</h3>
<ol type="1">
<li><p>建立maven工程</p></li>
<li><p>添加依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>java代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 此时的Logger的package如下：</span></span><br><span class="line"><span class="keyword">import</span> org.apache.log4j.Logger;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化系统配置，不需要配置文件</span></span><br><span class="line">    BasicConfigurator.configure();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建日志记录器对象 此处的Logger类为org.apache.log4j.Logger</span></span><br><span class="line">    Logger logger = Logger.getLogger(Log4jTest.class);</span><br><span class="line">    <span class="comment">// 日志记录输出</span></span><br><span class="line">    logger.info(<span class="string">&quot;hello log4j&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 日志级别</span></span><br><span class="line">    logger.fatal(<span class="string">&quot;fatal&quot;</span>);  <span class="comment">// 严重错误，一般会造成系统崩溃和终止运行</span></span><br><span class="line">    logger.error(<span class="string">&quot;error&quot;</span>);  <span class="comment">// 错误信息，但不会影响系统运行</span></span><br><span class="line">    logger.warn(<span class="string">&quot;warn&quot;</span>);    <span class="comment">// 警告信息，可能会发生问题</span></span><br><span class="line">    logger.info(<span class="string">&quot;info&quot;</span>);    <span class="comment">// 程序运行信息，数据库的连接、网络、IO操作等</span></span><br><span class="line">    logger.debug(<span class="string">&quot;debug&quot;</span>);  <span class="comment">// 调试信息，一般在开发阶段使用，记录程序的变量、参数等</span></span><br><span class="line">    logger.trace(<span class="string">&quot;trace&quot;</span>);  <span class="comment">// 追踪信息，记录程序的所有流程信息</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>日志的级别</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">*</span> 每个Logger都被了一个日志级别（log level），用来控制日志信息的输出。日志级别从高到低分为：</span><br><span class="line"><span class="code">	fatal  指出每个严重的错误事件将会导致应用程序的退出。</span></span><br><span class="line"><span class="code">	error  指出虽然发生错误事件，但仍然不影响系统的继续运行。</span></span><br><span class="line"><span class="code">	warn   表明会出现潜在的错误情形。</span></span><br><span class="line"><span class="code">	info   一般和在粗粒度级别上，强调应用程序的运行全程。</span></span><br><span class="line"><span class="code">	debug  一般用于细粒度级别上，对调试应用程序非常有帮助。</span></span><br><span class="line"><span class="code">	trace  是程序追踪，可以用于输出程序运行中的变量，显示执行的流程。</span></span><br><span class="line"><span class="code">* 还有两个特殊的级别：</span></span><br><span class="line"><span class="code">	OFF    可用来关闭日志记录。</span></span><br><span class="line"><span class="code">	ALL    启用所有消息的日志记录</span></span><br></pre></td></tr></table></figure></li>
</ol>
<blockquote>
<p>注：一般只使用4个级别，优先级从高到低为 ERROR &gt; WARN &gt; INFO &gt; DEBUG</p>
</blockquote>
<h3 id="log4j组件">4.2 Log4j组件</h3>
<p>Log4J 主要由 Loggers (日志记录器)、Appenders（输出端）和 Layout（日志格式化器）组成。其中：</p>
<ul>
<li>Loggers 控制日志的输出级别与日志是否输出；</li>
<li>Appenders 指定日志的输出方式（输出到控制台、文件等）；</li>
<li>Layout 控制日志信息的输出格式。</li>
</ul>
<h4 id="loggers">4.2.1 Loggers</h4>
<p>日志记录器，负责收集处理日志记录，实例的命名就是类的 full quailied name（类的全限定名），Logger的名字大小写敏感，其命名有继承机制：例如：name为<code>org.apache.commons</code>的logger会继承name为<code>org.apache</code>的logger。</p>
<p>Log4J中有一个特殊的logger叫做“root”，他是所有logger的根，也就意味着其他所有的logger都会直接或者间接地继承自root。root logger可以用<code>Logger.getRootLogger()</code>方法获取。</p>
<p>但是，自log4j 1.2版以来， Logger 类已经取代了 Category 类。对于熟悉早期版本的log4j的人来说，Logger 类可以被视为 Category 类的别名。</p>
<p><img src="/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/log4j.PNG" alt="log4j"></p>
<h4 id="appenders">4.2.2 Appenders</h4>
<p>Appender 用来指定日志输出到哪个地方，可以同时指定日志的输出目的地。Log4j 常用的输出目的地有以下几种：</p>
<table>
<colgroup>
<col style="width: 30%">
<col style="width: 69%">
</colgroup>
<thead>
<tr class="header">
<th>输出端类型</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ConsoleAppender</code></td>
<td>将日志输出到控制台</td>
</tr>
<tr class="even">
<td><code>FileAppender</code></td>
<td>将日志输出到文件中</td>
</tr>
<tr class="odd">
<td><code>DailyRollingFileAppender</code></td>
<td>将日志输出到一个日志文件，并且每天输出到一个新的文件</td>
</tr>
<tr class="even">
<td><code>RollingFileAppender</code></td>
<td>将日志信息输出到一个日志文件，并且指定文件的尺寸，当文件大小达到指定尺寸时，会自动把文件改名，同时产生一个新的文件</td>
</tr>
<tr class="odd">
<td><code>JDBCAppender</code></td>
<td>把日志信息保存到数据库中</td>
</tr>
</tbody>
</table>
<h4 id="layouts">4.2.3 Layouts</h4>
<p>布局器Layouts用于控制日志输出内容的格式，让我们可以使用各种需要的格式输出日志。Log4j常用的Layouts:</p>
<table>
<thead>
<tr class="header">
<th>格式化器类型</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>HTMLLayout</code></td>
<td>格式化日志输出为HTML表格形式</td>
</tr>
<tr class="even">
<td><code>SimpleLayout</code></td>
<td>简单的日志输出格式化，打印的日志格式为（info - message）</td>
</tr>
<tr class="odd">
<td><code>PatternLayout</code></td>
<td>最强大的格式化期，可以根据自定义格式输出日志，如果没有指定转换格式， 就是用默认的转换格式</td>
</tr>
</tbody>
</table>
<h3 id="layout的格式">4.3 Layout的格式</h3>
<p>在 <code>log4j.properties</code> 配置文件中，可以定义了日志输出级别与输出端，在输出端中分别配置日志的输出格式。</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">*</span> log4j采用类似C语言的printf函数的打印格式格式化日志信息，具体的占位符及其含义如下：</span><br><span class="line"><span class="code">	%m 输出代码中指定的日志信息</span></span><br><span class="line"><span class="code">	%p 输出优先级，及DEBUG、INFO等</span></span><br><span class="line"><span class="code">	%n 换行符（Windows平台的换行符为 &quot;\r\n&quot;，Unix 平台为 &quot;\n&quot;）</span></span><br><span class="line"><span class="code">	%r 输出自应用启动到输出该log信息耗费的毫秒数</span></span><br><span class="line"><span class="code">	%c 输出打印语句所属的类的全名</span></span><br><span class="line"><span class="code">	%t 输出产生该日志的线程全名</span></span><br><span class="line"><span class="code">	%d 输出服务器当前时间，默认为ISO8601，也可以指定格式，如：%d&#123;yyyy年MM月dd日HH:mm:ss&#125;</span></span><br><span class="line"><span class="code">	%l 输出日志时间发生的位置，包括类名、线程、及在代码中的行数。如：Test.main(Test.java:10)</span></span><br><span class="line"><span class="code">	%F 输出日志消息产生时所在的文件名称</span></span><br><span class="line"><span class="code">	%L 输出代码中的行号</span></span><br><span class="line"><span class="code">	%% 输出一个 &quot;%&quot; 字符</span></span><br><span class="line"><span class="code">* 可以在%与字符之间加上修饰符来控制最小宽度、最大宽度和文本的对其方式。如：</span></span><br><span class="line"><span class="code">	%5c 输出category名称，最小宽度是5，category&lt;5，默认的情况下右对齐</span></span><br><span class="line"><span class="code">	%-5c 输出category名称，最小宽度是5，category&lt;5，&quot;-&quot;号指定左对齐,会有空格</span></span><br><span class="line"><span class="code">	%.5c 输出category名称，最大宽度是5，category&gt;5，就会将左边多出的字符截掉，&lt;5不会有空格</span></span><br><span class="line"><span class="code">	%20.30c category名称&lt;20补空格，并且右对齐，&gt;30字符，就从左边交远销出的字符截掉</span></span><br></pre></td></tr></table></figure>
<p>示例：</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 指定RootLogger顶级父元素默认配置信息</span></span><br><span class="line"><span class="comment"># 日志级别=trace, 使用的appender为console</span></span><br><span class="line"><span class="meta">log4j.rootLogger</span> = <span class="string">trace, console</span></span><br><span class="line"><span class="comment"># 控制台输出控制</span></span><br><span class="line"><span class="comment"># key = log4j.appender.name  name可以随意 但是name再后面的内容为ognl对象图导航语言</span></span><br><span class="line"><span class="comment"># 指定控制台日志输出的appender</span></span><br><span class="line"><span class="meta">log4j.appender.console</span> = <span class="string">org.apache.log4j.ConsoleAppender</span></span><br><span class="line"><span class="comment"># 指定消息哥格式layout</span></span><br><span class="line"><span class="meta">log4j.appender.console.layout</span> = <span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="comment"># 指定消息格式内容</span></span><br><span class="line"><span class="comment"># 0 [main] FATAL cn.xyc.Log4jTest  - fatal</span></span><br><span class="line"><span class="comment"># ...</span></span><br><span class="line"><span class="comment"># 1 [main] TRACE cn.xyc.Log4jTest  - trace</span></span><br><span class="line"><span class="meta">log4j.appender.console.layout.conversionPattern</span> = <span class="string">%r [%t] %p %c %x - %m%n</span></span><br></pre></td></tr></table></figure>
<h3 id="appender的输出">4.4 Appender的输出</h3>
<h4 id="appender输出到控制台">4.4.1 Appender输出到控制台</h4>
<ul>
<li><p><code>log4j.properties</code></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 指定RootLogger顶级父元素默认配置信息</span></span><br><span class="line"><span class="comment"># 日志级别=trace, 使用的appender为console</span></span><br><span class="line"><span class="meta">log4j.rootLogger</span> = <span class="string">trace, console</span></span><br><span class="line"><span class="comment"># 控制台输出控制</span></span><br><span class="line"><span class="comment"># key = log4j.appender.name  name可以随意 但是name再后面的内容为ognl对象图导航语言</span></span><br><span class="line"><span class="comment"># 指定控制台日志输出的appender</span></span><br><span class="line"><span class="meta">log4j.appender.console</span> = <span class="string">org.apache.log4j.ConsoleAppender</span></span><br><span class="line"><span class="comment"># 指定消息格式layout</span></span><br><span class="line"><span class="meta">log4j.appender.console.layout</span> = <span class="string">org.apache.log4j.SimpleLayout</span></span><br></pre></td></tr></table></figure></li>
<li><p>java代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test02</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 开启log4j内置日志记录</span></span><br><span class="line">    LogLog.setInternalDebugging(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建日志记录器对象 此处的Logger为org.apache.log4j.Logger</span></span><br><span class="line">    Logger logger = Logger.getLogger(Log4jTest.class);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 日志级别 根据上述log4j.properties设定，此处只输出tarce等级以上的日志记录信息</span></span><br><span class="line">    logger.fatal(<span class="string">&quot;fatal&quot;</span>);  <span class="comment">// 严重错误，一般会造成系统崩溃和终止运行</span></span><br><span class="line">    logger.error(<span class="string">&quot;error&quot;</span>);  <span class="comment">// 错误信息，但不会影响系统运行</span></span><br><span class="line">    logger.warn(<span class="string">&quot;warn&quot;</span>);    <span class="comment">// 警告信息，可能会发生问题</span></span><br><span class="line">    logger.info(<span class="string">&quot;info&quot;</span>);    <span class="comment">// 程序运行信息，数据库的连接、网络、IO操作等</span></span><br><span class="line">    logger.debug(<span class="string">&quot;debug&quot;</span>);  <span class="comment">// 调试信息，一般在开发阶段使用，记录程序的变量、参数等</span></span><br><span class="line">    logger.trace(<span class="string">&quot;trace&quot;</span>);  <span class="comment">// 追踪信息，记录程序的所有流程信息</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="appender输出到文件中">4.4.2 Appender输出到文件中</h4>
<ul>
<li><p><code>log4j.properties</code></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 指定RootLogger顶级父元素默认配置信息</span></span><br><span class="line"><span class="meta">log4j.rootLogger</span> = <span class="string">trace, console, file, roolingFile, dailyFile</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># --- FileAppender ---</span></span><br><span class="line"><span class="comment">## 文件输出控制</span></span><br><span class="line"><span class="comment"># 指定文件日志输出的appender</span></span><br><span class="line"><span class="meta">log4j.appender.file</span> = <span class="string">org.apache.log4j.FileAppender</span></span><br><span class="line"><span class="comment"># 指定消息格式layout</span></span><br><span class="line"><span class="meta">log4j.appender.file.layout</span> = <span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="comment"># 指定消息格式内容</span></span><br><span class="line"><span class="meta">log4j.appender.file.layout.conversionPattern</span> = <span class="string">%-d&#123;yyyy-MM-dd HH:mm:ss&#125; [%t:%r] - [%p] %m%n</span></span><br><span class="line"><span class="comment"># 指定日志文件的保存路径</span></span><br><span class="line"><span class="meta">log4j.appender.file.file</span> = <span class="string">./logs/log4j.log</span></span><br><span class="line"><span class="comment"># 指定日志文件的字符集</span></span><br><span class="line"><span class="meta">log4j.appender.file.encoding</span> = <span class="string">UTF-8</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># --- RollingFileAppender ---</span></span><br><span class="line"><span class="comment"># 按照文件大小拆分的appender对象</span></span><br><span class="line"><span class="meta">log4j.appender.roolingFile</span> = <span class="string">org.apache.log4j.RollingFileAppender</span></span><br><span class="line"><span class="meta">log4j.appender.roolingFile.layout</span> = <span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.roolingFile.layout.conversionPattern</span> = <span class="string">%-d&#123;yyyy-MM-dd HH:mm:ss&#125; [%t:%r] - [%p] %m%n</span></span><br><span class="line"><span class="meta">log4j.appender.roolingFile.file</span> = <span class="string">./logs/log4j.log</span></span><br><span class="line"><span class="meta">log4j.appender.roolingFile.encoding</span> = <span class="string">UTF-8</span></span><br><span class="line"><span class="comment"># 指定日志文件大小</span></span><br><span class="line"><span class="meta">log4j.appender.roolingFile.maxFileSize</span> = <span class="string">1MB</span></span><br><span class="line"><span class="comment"># 指定日志文件的数量 超过则按照时间进行覆盖</span></span><br><span class="line"><span class="meta">log4j.appender.roolingFile.maxBackupIndex</span> = <span class="string">10</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># --- DailyRollingFileAppender ---</span></span><br><span class="line"><span class="comment"># 按照时间规则拆分的appender对象</span></span><br><span class="line"><span class="meta">log4j.appender.dailyFile</span> = <span class="string">org.apache.log4j.DailyRollingFileAppender</span></span><br><span class="line"><span class="meta">log4j.appender.dailyFile.layout</span> = <span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.dailyFile.layout.conversionPattern</span> = <span class="string">%-d&#123;yyyy-MM-dd HH:mm:ss&#125; [%t:%r] - [%p] %m%n</span></span><br><span class="line"><span class="meta">log4j.appender.dailyFile.file</span> = <span class="string">./logs/log4j.log</span></span><br><span class="line"><span class="meta">log4j.appender.dailyFile.encoding</span> = <span class="string">UTF-8</span></span><br><span class="line"><span class="comment"># 指定日期拆分规则</span></span><br><span class="line"><span class="meta">log4j.appender.dailyFile.datePattern</span> = <span class="string">&#x27;.&#x27;yyyy-MM-dd-HH-mm-ss</span></span><br></pre></td></tr></table></figure></li>
<li><p>java代码同上</p></li>
</ul>
<h4 id="appender输出到数据库中">4.4.3 Appender输出到数据库中</h4>
<ul>
<li><p>数据库建表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE `log` (</span><br><span class="line">	`log_id` INT(11) NOT NULL AUTO_INCREMENT,</span><br><span class="line">	`project_name` VARCHAR(255) DEFAULT NULL COMMENT &#x27;目项名&#x27;,</span><br><span class="line">	`create_date` VARCHAR(255) DEFAULT NULL COMMENT &#x27;创建时间&#x27;,</span><br><span class="line">	`level` VARCHAR(255) DEFAULT NULL COMMENT &#x27;优先级&#x27;,</span><br><span class="line">	`category` VARCHAR(255) DEFAULT NULL COMMENT &#x27;所在类的全名&#x27;,</span><br><span class="line">	`file_name` VARCHAR(255) DEFAULT NULL COMMENT &#x27;输出日志消息产生时所在的文件名称 &#x27;,</span><br><span class="line">	`thread_name` VARCHAR(255) DEFAULT NULL COMMENT &#x27;日志事件的线程名&#x27;,</span><br><span class="line">	`line` VARCHAR(255) DEFAULT NULL COMMENT &#x27;号行&#x27;,</span><br><span class="line">	`all_category` VARCHAR(255) DEFAULT NULL COMMENT &#x27;日志事件的发生位置&#x27;,</span><br><span class="line">	`message` VARCHAR(4000) DEFAULT NULL COMMENT &#x27;输出代码中指定的消息&#x27;,</span><br><span class="line">	PRIMARY KEY (`log_id`)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li>
<li><p><code>log4j.properties</code></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 指定RootLogger顶级父元素默认配置信息</span></span><br><span class="line"><span class="meta">log4j.rootLogger</span> = <span class="string">trace, logDB</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#mysql</span></span><br><span class="line"><span class="meta">log4j.appender.logDB</span>=<span class="string">org.apache.log4j.jdbc.JDBCAppender</span></span><br><span class="line"><span class="meta">log4j.appender.logDB.layout</span>=<span class="string">org.apache.log4j.PatternLayout</span></span><br><span class="line"><span class="meta">log4j.appender.logDB.Driver</span>=<span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line"><span class="meta">log4j.appender.logDB.URL</span>=<span class="string">jdbc:mysql://localhost:3306/db1</span></span><br><span class="line"><span class="meta">log4j.appender.logDB.User</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">log4j.appender.logDB.Password</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">log4j.appender.logDB.Sql</span>=<span class="string">INSERT INTO log(project_name,create_date,level,category,file_name,thread_name,line,all_category,message) values(&#x27;itcast&#x27;,&#x27;%d&#123;yyyy-MM-dd HH:mm:ss&#125;&#x27;,&#x27;%p&#x27;,&#x27;%c&#x27;,&#x27;%F&#x27;,&#x27;%t&#x27;,&#x27;%L&#x27;,&#x27;%l&#x27;,&#x27;%m&#x27;)</span></span><br></pre></td></tr></table></figure></li>
<li><p>java代码同上</p></li>
</ul>
<h3 id="自定义logger">4.5 自定义Logger</h3>
<ul>
<li><p><code>log4j.properties</code></p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 指定RootLogger顶级父元素默认配置信息</span></span><br><span class="line"><span class="comment"># 日志级别=trace, 使用的appender为console</span></span><br><span class="line"><span class="meta">log4j.rootLogger</span> = <span class="string">trace, console</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 自定义logger对象配置</span></span><br><span class="line"><span class="comment"># 此时cn.xyc包下的类使用的就是下面配置</span></span><br><span class="line"><span class="meta">log4j.logger.cn.xyc</span> = <span class="string">info, file</span></span><br><span class="line"><span class="comment"># 则org.apache包下的类的日志记录级别为error</span></span><br><span class="line"><span class="meta">log4j.logger.org.apache</span> = <span class="string">error</span></span><br></pre></td></tr></table></figure></li>
<li><p>java代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test03</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建日志记录器对象 此处的Logger类为org.apache.log4j.Logger</span></span><br><span class="line">    <span class="comment">// 采用了自定义的Logger对象类</span></span><br><span class="line">    Logger logger = Logger.getLogger(Log4jTest.class);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 日志记录输出</span></span><br><span class="line">    logger.info(<span class="string">&quot;hello log4j&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 日志级别 -- 输出info以上的信息</span></span><br><span class="line">    logger.fatal(<span class="string">&quot;fatal&quot;</span>);  <span class="comment">// 严重错误，一般会造成系统崩溃和终止运行</span></span><br><span class="line">    logger.error(<span class="string">&quot;error&quot;</span>);  <span class="comment">// 错误信息，但不会影响系统运行</span></span><br><span class="line">    logger.warn(<span class="string">&quot;warn&quot;</span>);    <span class="comment">// 警告信息，可能会发生问题</span></span><br><span class="line">    logger.info(<span class="string">&quot;info&quot;</span>);    <span class="comment">// 程序运行信息，数据库的连接、网络、IO操作等</span></span><br><span class="line">    logger.debug(<span class="string">&quot;debug&quot;</span>);  <span class="comment">// 调试信息，一般在开发阶段使用，记录程序的变量、参数等</span></span><br><span class="line">    logger.trace(<span class="string">&quot;trace&quot;</span>);  <span class="comment">// 追踪信息，记录程序的所有流程信息</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 再创建一个日志记录器对象</span></span><br><span class="line">    <span class="comment">// Logger.class为apache包下的类，因此也采用了自定义Logger</span></span><br><span class="line">    Logger logger1 = Logger.getLogger(Logger.class);</span><br><span class="line">    <span class="comment">// 日志级别  -- 输出error以上的信息</span></span><br><span class="line">    logger1.fatal(<span class="string">&quot;fatal&quot;</span>);  <span class="comment">// 严重错误，一般会造成系统崩溃和终止运行</span></span><br><span class="line">    logger1.error(<span class="string">&quot;error&quot;</span>);  <span class="comment">// 错误信息，但不会影响系统运行</span></span><br><span class="line">    logger1.warn(<span class="string">&quot;warn&quot;</span>);    <span class="comment">// 警告信息，可能会发生问题</span></span><br><span class="line">    logger1.info(<span class="string">&quot;info&quot;</span>);    <span class="comment">// 程序运行信息，数据库的连接、网络、IO操作等</span></span><br><span class="line">    logger1.debug(<span class="string">&quot;debug&quot;</span>);  <span class="comment">// 调试信息，一般在开发阶段使用，记录程序的变量、参数等</span></span><br><span class="line">    logger1.trace(<span class="string">&quot;trace&quot;</span>);  <span class="comment">// 追踪信息，记录程序的所有流程信息</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="jcl-学习">5. JCL 学习</h2>
<p>全称为Jakarta Commons Logging，是Apache提供的一个通用日志API。</p>
<p>这是为 &quot;所有的Java日志实现&quot;提供一个统一的接口，它自身也提供一个日志的实现，但是功能非常常弱(SimpleLog)。所以一般不会单独使用它。他允许开发人员使用不同的具体日志实现工具: Log4j，Jdk自带的日志（JUL)</p>
<p>JCL 有两个基本的抽象类：Log（基本记录器）和LogFactory（负责创建Log实例）。</p>
<p><img src="/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/JCL.PNG" alt="JCL"></p>
<h3 id="jcl入门">5.1 JCL入门</h3>
<ol type="1">
<li><p>建立maven工程</p></li>
<li><p>添加依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-logging<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>入门代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 下述LogFactory所对应的package</span></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.logging.LogFactory;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">    <span class="comment">// 获取log日志记录器对象</span></span><br><span class="line">    Log log = LogFactory.getLog(JCLTest.class);</span><br><span class="line">    <span class="comment">// 日志记录输出</span></span><br><span class="line">    <span class="comment">// 当没有导入log4j依赖时默认使用JUL，导入时则默认使用log4j</span></span><br><span class="line">    log.info(<span class="string">&quot;hello jcl&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<p><strong>为什么要使用日志门面：</strong></p>
<ol type="1">
<li>面向接口开发，不再依赖具体的实现类，减少代码的耦合；</li>
<li>项目通过导入不同的日志实现类，可以灵活的切换日志框架；</li>
<li>统一API，方便开发者学习和使用；</li>
<li>统一配置便于项目日志的管理。</li>
</ol>
<h3 id="jcl原理">5.2 JCL原理</h3>
<ol type="1">
<li><p>通过LogFactory动态加载Log实现类</p>
<p><img src="/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/jcl实现原理.PNG" alt="jcl实现原理"></p></li>
<li><p>日志门面支持的日志实现数组</p></li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String[] classesToDiscover = <span class="keyword">new</span> String[]&#123;</span><br><span class="line">    <span class="string">&quot;org.apache.commons.logging.impl.Log4JLogger&quot;</span>,</span><br><span class="line">    <span class="string">&quot;org.apache.commons.logging.impl.Jdk14Logger&quot;</span>,</span><br><span class="line">    <span class="string">&quot;org.apache.commons.logging.impl.Jdk13LumberjackLogger&quot;</span>,</span><br><span class="line">    <span class="string">&quot;org.apache.commons.logging.impl.SimpleLog&quot;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ol start="3" type="1">
<li>获取具体的日志实现</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; classesToDiscover.length &amp;&amp; result == <span class="keyword">null</span>; ++i) &#123;</span><br><span class="line">    result = <span class="keyword">this</span>.createLogFromClass(</span><br><span class="line">        classesToDiscover[i], </span><br><span class="line">        logCategory, <span class="keyword">true</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="日志门面">6. 日志门面</h2>
<p>当系统变的更加复杂的时候，日志就容易发生混乱。随着系统开发的进行，可能会更新不同的日志框架，造成当前系统中存在不同的日志依赖，使得难以进行统一的管理和控制。就算强制要求所有的模块使用相同的日志框架，系统中也难以避免使用其他类似spring，mybatis等其他的第三方框架，它们依赖于不同的日志框架，而且他们自身的日志系统就有着不一致性，依然会出现日志体系的混乱。</p>
<p>此时可以借鉴JDBC的思想，为日志系统也提供一套门面，那么就可以面向这些接口规范来开发，避免了直接依赖具体的日志框架。这样系统在日志中，就存在了日志的门面和日志的实现。</p>
<ul>
<li><p>常见的<strong>日志门面</strong>：JCL、slf4j</p></li>
<li><p>常见的<strong>日志实现</strong>：JUL、log4j、logback、log4j2</p></li>
</ul>
<p>日志门面和日志实现的关系：</p>
<p><img src="/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/日志门面和日志实现的关系.PNG" alt="日志门面和日志实现的关系"></p>
<p>日志框架出现的历史顺序：log4j --&gt; JUL--&gt; JCL --&gt; slf4j --&gt; logback --&gt; log4j2</p>
<h2 id="slf4j的使用">7. SLF4J的使用</h2>
<p>简单日志门面(Simple Logging Facade For Java) SLF4J主要是为了给Java日志访问提供一套标准、规范的API框架，其<strong>主要意义在于提供接口</strong>，具体的实现可以交由其他日志框架，例如log4j和logback等。当然slf4j自己也提供了功能较为简单的实现，但是一般很少用到。</p>
<p>对于一般的Java项目而言，日志框架会选择slf4j-api作为门面，配上具体的实现框架（log4j、logback等），中间使用桥接器完成桥接。</p>
<p>官方网站： https://www.slf4j.org/</p>
<p>SLF4J是目前市面上最流行的日志门面。现在的项目中，基本上都是使用SLF4J作为我们的日志系统。</p>
<p>SLF4J日志门面主要提供两大功能：</p>
<ol type="1">
<li>日志框架的绑定</li>
<li>日志框架的桥接</li>
</ol>
<h3 id="slf4j入门">7.1 SLF4J入门</h3>
<ol type="1">
<li><p>添加依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--slf4j core 使用slf4j必須添加--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--slf4j 自带的简单日志实现 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-simple<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>编写代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 下述的Logger对应的Package</span></span><br><span class="line"><span class="comment">// import org.slf4j.Logger;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger LOGGER = LoggerFactory.getLogger(Slf4jTest.class);</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 日志输出</span></span><br><span class="line">    LOGGER.error(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">    LOGGER.warn(<span class="string">&quot;warn&quot;</span>);</span><br><span class="line">    LOGGER.info(<span class="string">&quot;info&quot;</span>);</span><br><span class="line">    LOGGER.debug(<span class="string">&quot;debug&quot;</span>);</span><br><span class="line">    LOGGER.trace(<span class="string">&quot;trace&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用占位符进行日志的输出</span></span><br><span class="line">    String name = <span class="string">&quot;xyc&quot;</span>;</span><br><span class="line">    Integer age = <span class="number">25</span>;</span><br><span class="line">    LOGGER.info(<span class="string">&quot;用户: &#123;&#125;, &#123;&#125;&quot;</span>, name, age);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将系统的异常信息实处</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">1</span>/<span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        <span class="comment">// e.printStackTrace();</span></span><br><span class="line">        LOGGER.error(<span class="string">&quot;出现异常&quot;</span>, e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<p><strong>为什么要使用SLF4J作为日志门面？</strong></p>
<ul>
<li><p>使用SLF4J框架，可以在部署时迁移到所需的日志记录框架。</p></li>
<li>SLF4J提供了对所有流行的日志框架的绑定，例如：log4j，JUL，Simple logging和NOP。因此可以在部署时切换到任何这些流行的框架。</li>
<li>无论使用哪种绑定，SLF4J都支持参数化日志记录消息。由于SLF4J将应用程序和日志记录框架分离，因此可以轻松编写独立于日志记录框架的应用程序。而无需担心用于编写应用程序的日志记录框架。</li>
<li><p>SLF4J提供了一个简单的Java工具，称为迁移器。使用此工具，可以迁移现有项目，这些项目使用日志框架（JCL、log4j、JUL）到SLF4J。</p></li>
</ul>
<h3 id="绑定日志的实现binding">7.2 绑定日志的实现(Binding)</h3>
<p>如前所述，SLF4J支持各种日志框架。SLF4J发行版附带了几个称为“SLF4J绑定”的jar文件，每个绑定对应一个受支持的框架。</p>
<p><strong>使用slf4j的日志绑定流程:</strong></p>
<ol type="1">
<li>添加slf4j-api的依赖</li>
<li>使用slf4j的API在项目中进行统一的日志记录</li>
<li>绑定具体的日志实现框架
<ol type="1">
<li>绑定已经实现了slf4j的日志框架：直接添加对应依赖</li>
<li>绑定没有实现slf4j的日志框架：先添加日志的适配器，再添加实现类的依赖</li>
</ol></li>
<li>slf4j有且仅有一个日志实现框架的绑定（如果出现多个<strong>默认使用第一个依赖日志实现</strong>）</li>
</ol>
<p><strong>通过maven引入常见的日志实现框架：</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--slf4j core 使用slf4j必須添加--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- log4j--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-log4j12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- jul --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-jdk14<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--jcl --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-jcl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- nop --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-nop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>要切换日志框架，只需替换类路径上的slf4j绑定。例如，要从<code>java.util.logging</code>切换到log4j，只需将<code>slf4j-jdk14-1.7.27.jar</code>替换为<code>slf4j-log4j12-1.7.27.jar</code>即可。</p>
<p>SLF4J不依赖于任何特殊的类装载。实际上，每个SLF4J绑定在编译时都是硬连线的， 以使用一个且只有一个特定的日志记录框架。例如，<code>slf4j-log4j12-1.7.27.jar</code>绑定在编译时绑定以使用log4j。在代码中，除了<code>slf4j-api-1.7.27.jar</code>之外，只需将选择的<strong>一个且只有一个</strong>绑定放到相应的类路径位置。不要在类路径上放置多个绑定。以下是一般概念的图解说明。</p>
<p><img src="/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/slf4j绑定日志.PNG" alt="slf4j绑定日志"></p>
<p><strong>使用logback日志框架：</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--slf4j core 使用slf4j必須添加--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--slf4j 自带的简单日志实现 在使用logback时该其他的日志框架实现需要被注释 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;dependency&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;groupId&gt;org.slf4j&lt;/groupId&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;artifactId&gt;slf4j-simple&lt;/artifactId&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;version&gt;1.7.27&lt;/version&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--&lt;/dependency&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--logback日志实现--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ch.qos.logback<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logback-classic<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>日志开关slf4j-nop</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--slf4j core 使用slf4j必須添加--&gt;</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--nop日志开关 使用后slf4j不再使用日志功能--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-nop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.25<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>log4j日志框架使用</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--slf4j core 使用slf4j必須添加--&gt;</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--绑定log4j的日志实现，需要导入适配器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-log4j12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.17<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>JUL日志框架使用</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--slf4j core 使用slf4j必須添加--&gt;</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--绑定jul的日志实现，需要导入适配器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-jdk14<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="桥接旧的日志框架bridging">7.3 桥接旧的日志框架(Bridging)</h3>
<p>通常，存在依赖的某些组件依赖于SLF4J以外的日志记录API。可以假设这些组件在不久的将来不会切换到SLF4J。为了解决这种情况，SLF4J附带了几个桥接模块，这些模块将对log4j，JCL和JUL API的调用重定向，就好像它们是对SLF4J API一样。</p>
<p>桥接解决的是项目中日志的遗留问题，当系统中存在之前的日志API，可以通过桥接转换到slf4j的实现，如下：</p>
<ol type="1">
<li>先去除之前老的日志框架的依赖</li>
<li>添加SLF4J提供的桥接组件</li>
<li>为项目添加SLF4J的具体实现</li>
</ol>
<p><img src="/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/slf桥接旧的日志框架.PNG" alt="slf桥接旧的日志框架"></p>
<p><strong>迁移的方式</strong>：</p>
<p>如果我们要使用SLF4J的桥接器，替换原有的日志框架，那么我们需要做的第一件事情，就是删除掉原有项目中的日志框架的依赖。然后替换成SLF4J提供的桥接器。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--首先删除log4j的依赖--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--&lt;dependency&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;groupId&gt;log4j&lt;/groupId&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;artifactId&gt;log4j&lt;/artifactId&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;version&gt;1.2.17&lt;/version&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--&lt;/dependency&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--slf4j core 使用slf4j必須添加--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--配置log4j的桥接器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j-over-slf4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--配置jul的桥接器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jul-to-slf4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--配置jcl的桥接器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jcl-over-slf4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>注意问题：<br>
1. <code>jcl-over-slf4j.jar</code>和<code>slf4j-jcl.jar</code>不能同时部署。前一个jar文件将导致JCL将日志系统的选择委托给SLF4J，后一个jar文件将导致SLF4J将日志系统的选择委托给JCL，从而导致无限循环。<br>
2. <code>log4j-over-slf4j.jar</code>和<code>slf4j-log4j12.jar</code>不能同时出现，同理</p>
<ol start="3" type="1">
<li><code>jul-to-slf4j.jar</code>和<code>slf4j-jdk14.jar</code>不能同时出现，同理</li>
<li>所有的桥接都只对Logger日志记录器对象有效，如果程序中调用了内部的配置类或者是Appender，Filter等对象，将无法产生效果。</li>
</ol>
<h3 id="slf4j原理解析">7.4 SLF4J原理解析</h3>
<ol type="1">
<li>SLF4J通过LoggerFactory加载日志具体的实现对象。</li>
<li>LoggerFactory在初始化的过程中，会通过<code>performInitialization()</code>方法绑定具体的日志实现。</li>
<li>在绑定具体实现的时候，通过类加载器，加载org/slf4j/impl/StaticLoggerBinder.class</li>
<li>所以，只要是一个日志实现框架，在<code>org.slf4j.impl</code>包中提供一个自己的StaticLoggerBinder类，在其中提供具体日志实现的LoggerFactory就可以被SLF4J所加载</li>
</ol>
<h2 id="logback的使用">8. Logback的使用</h2>
<p>Logback是由log4j创始人设计的另一个开源日志组件，性能比log4j要好。</p>
<p>官方网站：https://logback.qos.ch/index.html</p>
<p>Logback主要分为三个模块：</p>
<ul>
<li>logback-core：其它两个模块的基础模块</li>
<li>logback-classic：它是log4j的一个改良版本，同时它完整实现了slf4j API</li>
<li>logback-access：访问模块与Servlet容器集成提供通过Http来访问日志的功能</li>
</ul>
<p>后续的日志代码都是通过SLF4J日志门面搭建日志系统，所以在代码是没有区别，主要是通过修改配置文件和pom.xml依赖</p>
<h3 id="logback入门">8.1 logback入门</h3>
<ol type="1">
<li><p>添加依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.25<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>ch.qos.logback<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>logback-classic<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>java代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LogBackTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger LOGGER = LoggerFactory.getLogger(LogBackTest.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line"></span><br><span class="line">        LOGGER.error(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">        LOGGER.warn(<span class="string">&quot;warn&quot;</span>);</span><br><span class="line">        LOGGER.info(<span class="string">&quot;info&quot;</span>);</span><br><span class="line">        LOGGER.debug(<span class="string">&quot;debug&quot;</span>);</span><br><span class="line">        LOGGER.trace(<span class="string">&quot;trace&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="logback配置">8.2 logback配置</h3>
<p>logback会依次读取以下类型配置文件：</p>
<ul>
<li>logback.groovy</li>
<li>logback-test.xml</li>
<li>logback.xml</li>
<li>如果均不存在会采用默认配置</li>
</ul>
<p>logback组件之间的关系：</p>
<ol type="1">
<li>Logger：日志的记录器，把它关联到应用的对应的context上后，主要用于存放日志对象，也可以定义日志类型、级别。</li>
<li>Appender：用于指定日志输出的目的地，目的地可以是控制台、文件、数据库等等。</li>
<li>Layout：负责把事件转换成字符串，格式化的日志信息的输出。在logback中Layout对象被封装在encoder中。</li>
</ol>
<p>控制台输出配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--配置集中管理属性，可以直接改属性的value值，格式:$&#123;name&#125;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--日志输出格式：</span></span><br><span class="line"><span class="comment">        	%-5level</span></span><br><span class="line"><span class="comment">        	%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125;日期</span></span><br><span class="line"><span class="comment">        	%c类的完整名称</span></span><br><span class="line"><span class="comment">        	%M为method</span></span><br><span class="line"><span class="comment">        	%L为行号</span></span><br><span class="line"><span class="comment">        	%thread线程名称</span></span><br><span class="line"><span class="comment">        	%m或者%msg为信息</span></span><br><span class="line"><span class="comment">        	%n换行--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度 %msg：日志消息，%n是换行符--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;pattern&quot;</span> <span class="attr">value</span>=<span class="string">&quot;%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; %c [%thread] %-5level %msg%n&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--Appender: 设置日志信息的去向,常用的有以下几个</span></span><br><span class="line"><span class="comment">            ch.qos.logback.core.ConsoleAppender (控制台)</span></span><br><span class="line"><span class="comment">            ch.qos.logback.core.rolling.RollingFileAppender (文件大小到达指定尺寸的时候产生一个新文件)</span></span><br><span class="line"><span class="comment">            ch.qos.logback.core.FileAppender (文件)</span></span><br><span class="line"><span class="comment">    --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--控制台日志输出的appender--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;console&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--控制输出流对象 默认System.out(黑色字体)改为System.err(红色字体)--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">target</span>&gt;</span>System.err<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--日志格式配置--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>$&#123;pattern&#125;<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line">   </span><br><span class="line">    <span class="comment">&lt;!--root logger配置--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;all&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;console&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line">   </span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>FileAppender 配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度 %msg：日志消息，%n是换行符--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;pattern&quot;</span> <span class="attr">value</span>=<span class="string">&quot;%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; %c [%thread] %-5level %msg%n&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--定义文件路径保存属性--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;log_dir&quot;</span> <span class="attr">value</span>=<span class="string">&quot;./logs/&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--日志文件输出的appender--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.FileAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--日志文件保存路径--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span>&gt;</span>$&#123;log_dir&#125;/logback.log<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--日志格式配置--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>$&#123;pattern&#125;<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--html格式日志文件输出的appender--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;htmlFile&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.FileAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--日志文件保存路径--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span>&gt;</span>$&#123;log_dir&#125;/logback.html<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--html消息格式的日志格式配置--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.encoder.LayoutWrappingEncoder&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">layout</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.html.HTMLLayout&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; %c %thread %-5level %msg<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--root logger配置--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;all&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;file&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;htmlFile&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line">   </span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>RollingFileAppender配置和Filter配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度 %msg：日志消息，%n是换行符--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;pattern&quot;</span> <span class="attr">value</span>=<span class="string">&quot;%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; %c [%thread] %-5level %msg%n&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--日志拆分和归档压缩的appender对象--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;rollFile&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--日志文件保存路径--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span>&gt;</span>$&#123;log_dir&#125;/roll_logback.log<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--日志格式配置--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>$&#123;pattern&#125;<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--指定拆分规则--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--按照时间和压缩格式声明拆分的文件名--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span>$&#123;log_dir&#125;/rolling.%d&#123;yyyy-MM-dd HH-mm-ss&#125;.log%i.gz<span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--按照文件大小进行拆分--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maxFileSize</span>&gt;</span>1KB<span class="tag">&lt;/<span class="name">maxFileSize</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--日志级别过滤器--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.LevelFilter&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--日志过滤规则--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>ERROR<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMatch</span>&gt;</span>ACCEPT<span class="tag">&lt;/<span class="name">onMatch</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">onMismatch</span>&gt;</span>DENY<span class="tag">&lt;/<span class="name">onMismatch</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--root logger配置--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;all&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;rollFile&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line">   </span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>异步日志配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--html格式日志文件输出的appender--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;htmlFile&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.FileAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--日志文件保存路径--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span>&gt;</span>$&#123;log_dir&#125;/logback.html<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--html消息格式的日志格式配置--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.encoder.LayoutWrappingEncoder&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">layout</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.html.HTMLLayout&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; %c %thread %-5level %msg<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">	<span class="comment">&lt;!--异步日志--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;async&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.AsyncAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 指定某个具体的appender --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;htmlFile&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--root logger配置--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;all&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;async&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line">   </span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>自定义logger对象配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">&lt;root&gt;也是&lt;logger&gt;元素，但是它是根logger。默认debug</span></span><br><span class="line"><span class="comment">	level:用来设置打印级别，大小写无关：TRACE, DEBUG, INFO, WARN, ERROR, ALL和OFF，</span></span><br><span class="line"><span class="comment">	&lt;root&gt;可以包含零个或多个&lt;appender-ref&gt;元素，标识这个appender将会添加到这个logger。</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--root logger配置--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;all&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;console&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;file&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;htmlFile&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;rollFile&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;async&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- logger用来设置某一个包或者具体的某一个类的日志打印级别、以及指定&lt;appender&gt;。</span></span><br><span class="line"><span class="comment">	&lt;logger&gt;仅有一个name属性，一个可选的level和一个可选的addtivity属性</span></span><br><span class="line"><span class="comment">    name:用来指定受此logger约束的某一个包或者具体的某一个类。</span></span><br><span class="line"><span class="comment">    level:用来设置打印级别，大小写无关：TRACE, DEBUG, INFO, WARN, ERROR, ALL和OFF，如果未设置此属性，那么当前logger将会继承上级的级别。</span></span><br><span class="line"><span class="comment">    additivity:自定义logger对象是否继承rootlogger ture表示会继承</span></span><br><span class="line"><span class="comment">	&lt;logger&gt;可以包含零个或多个&lt;appender-ref&gt;元素，标识这个appender将会添加到这个logger</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--自定义logger对象 name表示该子包下的所有类都属于该logger对象的子实现--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;cn.xyc&quot;</span> <span class="attr">level</span>=<span class="string">&quot;info&quot;</span> <span class="attr">additivity</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;console&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>官方提供的log4j.properties转换成logback.xml：https://logback.qos.ch/translator/</p>
<h3 id="logback-access的使用">8.3 logback-access的使用</h3>
<p>logback-access模块与Servlet容器（如Tomcat和Jetty）集成，以提供HTTP访问日志功能。我们可以使用logback-access模块来替换tomcat的访问日志。</p>
<ol type="1">
<li><p>将logback-access.jar与logback-core.jar复制到<code>$TOMCAT_HOME/lib/</code>目录下</p></li>
<li><p>修改<code>$TOMCAT_HOME/conf/server.xml</code>中的Host元素中添加：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Valve</span> <span class="attr">className</span>=<span class="string">&quot;ch.qos.logback.access.tomcat.LogbackValve&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>logback默认会在<code>$TOMCAT_HOME/conf</code>下查找文件 <code>logback-access.xml</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- always a good activate OnConsoleStatusListener --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">statusListener</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.status.OnConsoleStatusListener&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;LOG_DIR&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;catalina.base&#125;/logs&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;FILE&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">file</span>&gt;</span>$&#123;LOG_DIR&#125;/access.log<span class="tag">&lt;/<span class="name">file</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line">        	<span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span>access.%d&#123;yyyy-MM-dd&#125;.log.zip<span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 访问日志的格式 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>combined<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;FILE&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>官方配置： https://logback.qos.ch/access.html#configuration</p></li>
</ol>
<h2 id="log4j2的使用">9. log4j2的使用</h2>
<p>Apache Log4j2是对Log4j的升级版，参考了logback的一些优秀的设计，并且修复了一些问题，因此带来了一些重大的提升，主要有：</p>
<ul>
<li>异常处理，在logback中，Appender中的异常不会被应用感知到，但是在log4j2中，提供了一些异常处理机制。</li>
<li>性能提升，log4j2相较于log4j和logback都具有很明显的性能提升，后面会有官方测试的数据。</li>
<li>自动重载配置，参考了logback的设计，当然会提供自动刷新参数配置，最实用的就是我们在生产上可以动态的修改日志的级别而不需要重启应用。</li>
<li>无垃圾机制，log4j2在大部分情况下，都可以使用其设计的一套无垃圾机制，避免频繁的日志收集导致的JVM GC。</li>
</ul>
<p>官网： https://logging.apache.org/log4j/2.x/</p>
<h3 id="log4j2入门">9.1 Log4j2入门</h3>
<p>目前市面上最主流的日志门面就是SLF4J，虽然Log4j2也是日志门面，因为它的日志实现功能非常强大，性能优越。所以大家一般还是将Log4j2看作是日志的实现，Slf4j + Log4j2应该是未来的大势所趋。</p>
<p><strong>单独使用Log4j2：</strong></p>
<ol type="1">
<li><p>添加依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Log4j2门面API--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.11.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Log4j2 日志实现 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.11.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>JAVA代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 对应的Package</span></span><br><span class="line"><span class="comment">//	import org.apache.logging.log4j.LogManager;</span></span><br><span class="line"><span class="comment">// 	import org.apache.logging.log4j.Logger;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 直接使用log4j2作为实现代码</span></span><br><span class="line"><span class="comment">// 定义日志记录器对象</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger LOGGER = LogManager.getLogger(Log4j2Test.class);</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">    <span class="comment">// 日志记录输出</span></span><br><span class="line">    LOGGER.fatal(<span class="string">&quot;fatal&quot;</span>);</span><br><span class="line">    LOGGER.error(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">    LOGGER.warn(<span class="string">&quot;warn&quot;</span>);</span><br><span class="line">    LOGGER.info(<span class="string">&quot;info&quot;</span>);</span><br><span class="line">    LOGGER.debug(<span class="string">&quot;debug&quot;</span>);</span><br><span class="line">    LOGGER.trace(<span class="string">&quot;trace&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<p><strong>使用slf4j作为日志的门面,使用log4j2作为日志的实现：</strong></p>
<ol type="1">
<li><p>添加依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--使用slf4j作为日志的门面,使用log4j2来记录日志 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.25<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--为slf4j绑定日志实现 log4j2的适配器 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j-slf4j-impl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.10.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Log4j2 门面API--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.11.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Log4j2 日志实现 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.11.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>JAVA代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 对应的Package</span></span><br><span class="line"><span class="comment">//	import org.slf4j.Logger;</span></span><br><span class="line"><span class="comment">// 	import org.slf4j.LoggerFactory;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用slf4j作为日志门面调用log4j2作为日志实现代码</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger LOGGER = LoggerFactory.getLogger(Slf4jTest.class);</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 日志输出</span></span><br><span class="line">    LOGGER.error(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">    LOGGER.warn(<span class="string">&quot;warn&quot;</span>);</span><br><span class="line">    LOGGER.info(<span class="string">&quot;info&quot;</span>);</span><br><span class="line">    LOGGER.debug(<span class="string">&quot;debug&quot;</span>);</span><br><span class="line">    LOGGER.trace(<span class="string">&quot;trace&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用占位符进行日志的输出</span></span><br><span class="line">    String name = <span class="string">&quot;xyc&quot;</span>;</span><br><span class="line">    Integer age = <span class="number">25</span>;</span><br><span class="line">    LOGGER.info(<span class="string">&quot;用户: &#123;&#125;, &#123;&#125;&quot;</span>, name, age);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将系统的异常信息实处</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">1</span>/<span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        <span class="comment">// e.printStackTrace();</span></span><br><span class="line">        LOGGER.error(<span class="string">&quot;出现异常&quot;</span>, e);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="log4j2配置">9.2 Log4j2配置</h3>
<p>log4j2默认加载classpath下的 <code>log4j2.xml</code> 文件中的配置。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--status=&quot;warn&quot; 日志框架本身的输出日志级别，可选debug等</span></span><br><span class="line"><span class="comment">    monitorInterval=&quot;5&quot; 自动加载配置文件的时间间隔，不低于5s--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Configuration</span> <span class="attr">status</span>=<span class="string">&quot;warn&quot;</span> <span class="attr">monitorInterval</span>=<span class="string">&quot;5&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--集中配置属性进行管理,使用时通过:$&#123;name&#125;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;LOG_HOME&quot;</span>&gt;</span>./logs<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--日志处理--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Appenders</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--控制台输出 appender--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Console</span> <span class="attr">name</span>=<span class="string">&quot;Console&quot;</span> <span class="attr">target</span>=<span class="string">&quot;SYSTEM_OUT&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--格式表达式设置--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;%d&#123;HH:mm:ss.SSS&#125; [%t] [%-5level] %c&#123;36&#125;:%L --- %m%n&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Console</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--日志文件输出appender--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">File</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> <span class="attr">fileName</span>=<span class="string">&quot;$&#123;LOG_HOME&#125;/myfile.log&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;[%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125;] [%-5level] %l%c&#123;36&#125; - %m%n&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">File</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--使用随机读写流的日志文件输出appender 性能提高--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">RandomAccessFile</span> <span class="attr">name</span>=<span class="string">&quot;accessFile&quot;</span> <span class="attr">fileName</span>=<span class="string">&quot;$&#123;LOG_HOME&#125;/myAcclog.log&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;[%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125;] [%-5level] %l%c&#123;36&#125; - %m%n&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">RandomAccessFile</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--按照一定规则拆分的日志文件的appender--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">RollingFile</span> <span class="attr">name</span>=<span class="string">&quot;rollingFile&quot;</span> <span class="attr">fileName</span>=<span class="string">&quot;$&#123;LOG_HOME&#125;/myrollog.log&quot;</span></span></span><br><span class="line"><span class="tag">                     <span class="attr">filePattern</span>=<span class="string">&quot;./logs/$$&#123;date:yyyy-MM-dd&#125;/myrollog-%d&#123;yyyyMM-dd-HH-mm&#125;-%i.log&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--日志级别过滤器--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ThresholdFilter</span> <span class="attr">level</span>=<span class="string">&quot;debug&quot;</span> <span class="attr">onMatch</span>=<span class="string">&quot;ACCEPT&quot;</span> <span class="attr">onMismatch</span>=<span class="string">&quot;DENY&quot;</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--日志消息格式--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;[%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125;] [%-5level] %l%c&#123;36&#125; - %msg%n&quot;</span> /&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--日志拆分规则--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Policies</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--在系统启动时，触发拆分规则，产生一个新的日志文件--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">OnStartupTriggeringPolicy</span> /&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--按照文件大小进行拆分，10MB--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">SizeBasedTriggeringPolicy</span> <span class="attr">size</span>=<span class="string">&quot;10 MB&quot;</span> /&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--按照时间节点拆分,规则根据filepattern定义--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">TimeBasedTriggeringPolicy</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">Policies</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--在同一个目录下文件个数限定--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">DefaultRolloverStrategy</span> <span class="attr">max</span>=<span class="string">&quot;30&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">RollingFile</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Appenders</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--logger定义--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Loggers</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--使用rootlogger配置 日志级别 level=&quot;trace&quot;--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Root</span> <span class="attr">level</span>=<span class="string">&quot;trace&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--指定日志使用的处理器--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;Console&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Root</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Loggers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="log4j2异步日志">9.3 Log4j2异步日志</h3>
<p><strong>异步日志</strong>：log4j2最大的特点就是异步日志，其性能的提升主要也是从异步日志中受益，看看如何使用log4j2的异步日志。</p>
<ul>
<li><p><strong>同步日志</strong></p>
<p><img src="/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/log4j2同步日志.PNG" alt="log4j2同步日志"></p></li>
<li><p><strong>异步日志</strong></p>
<p><img src="/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/log4j2异步日志.PNG" alt="log4j2异步日志"></p></li>
</ul>
<p>Log4j2提供了两种实现日志的方式，一个是通过AsyncAppender，一个是通过AsyncLogger，分别对应前面我们说的Appender组件和Logger组件。</p>
<p>注意：配置异步日志需要添加依赖</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--异步日志依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.lmax<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>disruptor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.3.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol type="1">
<li><p>AsyncAppender方式</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Configuration</span> <span class="attr">status</span>=<span class="string">&quot;warn&quot;</span> <span class="attr">monitorInterval</span>=<span class="string">&quot;5&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--集中配置属性进行管理,使用时通过:$&#123;name&#125;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;LOG_HOME&quot;</span>&gt;</span>./logs<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--日志处理--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Appenders</span>&gt;</span></span><br><span class="line">     	<span class="comment">&lt;!--日志文件输出appender--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">File</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> <span class="attr">fileName</span>=<span class="string">&quot;$&#123;LOG_HOME&#125;/myfile.log&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;[%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125;] [%-5level] %l%c&#123;36&#125; - %m%n&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">File</span>&gt;</span></span><br><span class="line">    	<span class="comment">&lt;!--异步appender定义--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Async</span> <span class="attr">name</span>=<span class="string">&quot;Async&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;file&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Async</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">Appenders</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!--logger定义--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Loggers</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--使用rootlogger配置 日志级别 level=&quot;trace&quot;--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Root</span> <span class="attr">level</span>=<span class="string">&quot;trace&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--使用异步appender--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;Async&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Root</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Loggers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>AsyncLogger方式：<strong>AsyncLogger才是log4j2的重头戏</strong>，也是官方推荐的异步方式。它可以使得调用Logger.log返回的更快。你可以有两种选择：全局异步和混合异步。</p>
<ul>
<li><p><strong>全局异步</strong>就是，所有的日志都异步的记录，在配置文件上不用做任何改动，只需要添加一个<code>log4j2.component.properties</code>配置；</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">Log4jContextSelector</span>=<span class="string">org.apache.logging.log4j.core.async.AsyncLoggerContextSelector</span></span><br></pre></td></tr></table></figure></li>
<li><p><strong>混合异步</strong>就是，你可以在应用中同时使用同步日志和异步日志，这使得日志的配置方式更加灵活</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--logger定义--&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">Loggers</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--自定义异步logger对象</span></span><br><span class="line"><span class="comment">             includeLocation=&quot;false&quot; 关闭日志记录的行号信息</span></span><br><span class="line"><span class="comment">             additivity=&quot;false&quot; 不继承rootlogger对象--&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">AsyncLogger</span> <span class="attr">name</span>=<span class="string">&quot;cn.xyc&quot;</span> <span class="attr">level</span>=<span class="string">&quot;trace&quot;</span> <span class="attr">includeLocation</span>=<span class="string">&quot;false&quot;</span> <span class="attr">additivity</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;Console&quot;</span>/&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">AsyncLogger</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">     <span class="comment">&lt;!--使用rootlogger配置 日志级别 level=&quot;trace&quot;--&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">Root</span> <span class="attr">level</span>=<span class="string">&quot;trace&quot;</span>&gt;</span></span><br><span class="line">         <span class="comment">&lt;!--指定日志使用的处理器--&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;Console&quot;</span> /&gt;</span></span><br><span class="line">         <span class="comment">&lt;!--使用异步appender--&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;Async&quot;</span> /&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">Root</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">Loggers</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>如上配置： <code>cn.xyc</code>日志是异步的，<code>root</code>日志是同步的。</p>
<blockquote>
<p>当使用局部的异常日志时，需要先关闭全局异步配置上所加的内容，关闭全局异步日志</p>
</blockquote></li>
</ul></li>
</ol>
<p>使用异步日志需要<strong>注意的问题</strong>：</p>
<ol type="1">
<li>如果使用异步日志，AsyncAppender、AsyncLogger和全局日志，不要同时出现。性能会和AsyncAppender一致，降至最低。</li>
<li>设置<code>includeLocation=false</code>，打印位置信息会急剧降低异步日志的性能，比同步日志还要慢。</li>
</ol>
<h3 id="log4j2的性能">9.4 Log4j2的性能</h3>
<p>Log4j2最牛的地方在于异步输出日志时的性能表现，Log4j2在多线程的环境下吞吐量与Log4j和Logback的比较如下图。下图比较中Log4j2有三种模式：</p>
<ol type="1">
<li>全局使用异步模式（蓝色）；</li>
<li>部分Logger采用异步模式（红色）；</li>
<li>异步Appender（绿色）。</li>
</ol>
<p>可以看出在前两种模式下，Log4j2的性能较之Log4j和Logback有很大的优势。</p>
<p><img src="/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/log4j2性能.PNG" alt="log4j2性能"></p>
<p><strong>无垃圾记录</strong></p>
<p>垃圾收集暂停是延迟峰值的常见原因，并且对于许多系统而言，花费大量精力来控制这些暂停。</p>
<p>许多日志库（包括以前版本的Log4j）在稳态日志记录期间分配临时对象，如日志事件对象，字符串，字符数组，字节数组等。这会对垃圾收集器造成压力并增加GC暂停发生的频率。</p>
<p>从版本2.6开始，默认情况下Log4j以“无垃圾”模式运行，其中重用对象和缓冲区，并且尽可能不分配临时对象。还有一个“低垃圾”模式，它不是完全无垃圾，但不使用ThreadLocal字段。</p>
<p>Log4j 2.6中的无垃圾日志记录部分通过重用ThreadLocal字段中的对象来实现，部分通过在将文本转换为字节时重用缓冲区来实现。</p>
<p><strong>使用Log4j 2.5：内存分配速率809 MB /秒，141个无效集合。</strong></p>
<p><img src="/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/log4j2分配1.PNG" alt="log4j2分配1"></p>
<p><strong>Log4j 2.6没有分配临时对象：0（零）垃圾回收。</strong></p>
<p><img src="/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/log4j2分配2.PNG" alt="log4j2分配2"></p>
<p>有两个单独的系统属性可用于手动控制Log4j用于避免创建临时对象的机制：</p>
<ul>
<li><code>log4j2.enableThreadlocals</code> - 如果“true”（非Web应用程序的默认值）对象存储在ThreadLocal字段中并重新使用，否则将为每个日志事件创建新对象。</li>
<li><code>log4j2.enableDirectEncoders</code> - 如果将“true”（默认）日志事件转换为文本，则将此文本转换为字节而不创建临时对象。注意： 由于共享缓冲区上的同步，在此模式下多线程应用程序的同步日志记录性能可能更差。如果您的应用程序是多线程的并且日志记录性能很重要，请考虑使用异步记录器。</li>
</ul>
<h2 id="springboot中的日志使用">10. SpringBoot中的日志使用</h2>
<p>SpringBoot框架在企业中的使用越来越普遍，SpringBoot日志也是开发中常用的日志系统。</p>
<p><strong>SpringBoot默认就是使用SLF4J作为日志门面，logback作为日志实现来记录日志。</strong></p>
<h3 id="springboot中的日志设计">10.1 SpringBoot中的日志设计</h3>
<p>SpringBoot中的日志</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>依赖关系图：</p>
<p><img src="/2020/05/24/Java%E5%9F%BA%E7%A1%80/Java%E6%97%A5%E5%BF%97/Java%EF%BC%9A%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3/springboot依赖关系图.PNG" alt="springboot依赖关系图"></p>
<p>总结：<br>
1. SpringBoot底层默认使用logback作为日志实现。<br>
2. 使用了SLF4J作为日志门面<br>
3. 将JUL也转换成SLF4J<br>
4. 也可以使用log4j2作为日志门面，但是最终也是通过slf4j调用logback</p>
<h3 id="springboot日志使用">10.2 SpringBoot日志使用</h3>
<ol type="1">
<li><p>在springboot中测试打印日志</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="meta">@RunWith(SpringRunner.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoggingApplicationTests</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 声明日志记录器对象</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger LOGGER = LoggerFactory.getLogger(LoggingApplicationTests.class);</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// 日志输出</span></span><br><span class="line">		LOGGER.error(<span class="string">&quot;error&quot;</span>);</span><br><span class="line">		LOGGER.warn(<span class="string">&quot;warn&quot;</span>);</span><br><span class="line">		LOGGER.info(<span class="string">&quot;info&quot;</span>);  <span class="comment">//默认日志级别</span></span><br><span class="line">		LOGGER.debug(<span class="string">&quot;debug&quot;</span>);</span><br><span class="line">		LOGGER.trace(<span class="string">&quot;trace&quot;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 使用log4j2本质为使用桥接器切换为slf4j门面和logback日志实现</span></span><br><span class="line">		org.apache.logging.log4j.Logger logger = LogManager.getLogger(LoggingApplicationTests.class);</span><br><span class="line">		logger.info(<span class="string">&quot;log4j2 info&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>修改默认日志配置，在application.properties文件中进行配置</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将自定义logger对象日志级别</span></span><br><span class="line"><span class="meta">logging.level.cn.xyc</span>=<span class="string">trace</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 指定控制台输出消息格式</span></span><br><span class="line"><span class="meta">logging.pattern.console</span>=<span class="string">[%-5level] %d&#123;yyyy-MM-dd HH:mm:ss&#125; [%thread] === %msg%n</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"># 指定存放日志文件目录，默认的文件名为spring.log</span></span><br><span class="line"><span class="meta">logging.file.path</span>=<span class="string">./logs/</span></span><br><span class="line"><span class="comment"># 指定日志文件消息格式</span></span><br><span class="line"><span class="meta">logging.pattern.file</span>=<span class="string">[%-5level] %d&#123;yyyy-MM-dd HH:mm:ss&#125; [%thread] === %msg%n</span></span><br></pre></td></tr></table></figure></li>
<li><p>指定配置</p>
<p>给类路径下放上每个日志框架自己的配置文件；SpringBoot就不使用默认配置的了</p>
<table>
<thead>
<tr class="header">
<th>日志框架</th>
<th>配置文件</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Logback</td>
<td>logback-spring.xml , logback.xml</td>
</tr>
<tr class="even">
<td>Log4j2</td>
<td>log4j2-spring.xml ， log4j2.xml</td>
</tr>
<tr class="odd">
<td>JUL</td>
<td>logging.properties</td>
</tr>
</tbody>
</table>
<blockquote>
<p>logback.xml：直接就被日志框架识别了</p>
</blockquote>
<p>例如在resources文件夹下放置logback.xml文件，原先在application.properties文件中的内容就失效了</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度 %msg：日志消息，%n是换行符--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;pattern&quot;</span> <span class="attr">value</span>=<span class="string">&quot;%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; %c [%thread] %-5level ------ %msg%n&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--控制台日志输出的appender--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;console&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--控制输出流对象 默认 System.out（黑色字体） 改为 System.err（红色字体）--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">target</span>&gt;</span>System.err<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--日志格式配置--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>$&#123;pattern&#125;<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">&quot;cn.xyc&quot;</span> <span class="attr">level</span>=<span class="string">&quot;info&quot;</span> <span class="attr">additivity</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;console&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">logger</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>使用SpringBoot解析日志配置</p>
<p>logback-spring.xml：由SpringBoot解析日志配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--日志格式配置--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">encoder</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">springProfile</span> <span class="attr">name</span>=<span class="string">&quot;dev&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>$&#123;pattern&#125;<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">springProfile</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">springProfile</span> <span class="attr">name</span>=<span class="string">&quot;pro&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d&#123;yyyy-MM-dd HH:mm:ss.SSS&#125; %c [%thread] %-5level ++++++ %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">springProfile</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>application.properties</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 指定项目的具体环境</span></span><br><span class="line"><span class="meta">spring.profiles.active</span>=<span class="string">dev</span></span><br></pre></td></tr></table></figure></li>
<li><p>将日志切换为log4j2</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--排除logback--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-logging<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 添加log4j2 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-log4j2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>在resources中添加log4j2.xml配置文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Configuration</span> <span class="attr">status</span>=<span class="string">&quot;debug&quot;</span> <span class="attr">monitorInterval</span>=<span class="string">&quot;5&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--日志处理--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Appenders</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--控制台输出 appender--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Console</span> <span class="attr">name</span>=<span class="string">&quot;Console&quot;</span> <span class="attr">target</span>=<span class="string">&quot;SYSTEM_OUT&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--格式表达式设置--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;%d&#123;HH:mm:ss.SSS&#125; [%t] [%-5level] %c&#123;36&#125;:%L --- %m%n&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Console</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Appenders</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--logger定义--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Loggers</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--使用rootlogger配置 日志级别 level=&quot;trace&quot;--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Root</span> <span class="attr">level</span>=<span class="string">&quot;trace&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--指定日志使用的处理器--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;Console&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Root</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Loggers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>

    </div>

    
    
    
	
	<div>
		
			<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.css">

<div>
    
       <div style="text-align:center;color:#bfbfbf;font-size:16px;">
             <span>--- 本文结束 </span>
             <i class="fa fa-thumbs-o-up"></i>
             <span> 感谢阅读 ---</span>
       </div>
    
</div>
		
	</div>

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="tag"><i class="fa fa-hand-peace-o" aria-hidden="true"></i> 学习笔记</a>
              <a href="/tags/Java%E5%9F%BA%E7%A1%80/" rel="tag"><i class="fa fa-hand-peace-o" aria-hidden="true"></i> Java基础</a>
              <a href="/tags/%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6/" rel="tag"><i class="fa fa-hand-peace-o" aria-hidden="true"></i> 日志框架</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/05/17/%E8%BD%AF%E4%BB%B6%E4%BD%BF%E7%94%A8/screen%E7%94%A8%E6%B3%95%E5%B0%8F%E8%AE%B0/" rel="prev" title="screen用法小记">
      <i class="fa fa-chevron-left"></i> screen用法小记
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/05/31/%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A0/SpringBoot/Spring%20Boot%E7%AC%94%E8%AE%B0-1/" rel="next" title="SpringBoot：学习笔记-1">
      SpringBoot：学习笔记-1 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#java%E6%97%A5%E5%BF%97%E7%9B%B8%E5%85%B3"><span class="nav-text">Java：日志相关</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%97%A5%E5%BF%97%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="nav-text">1. 日志的概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6"><span class="nav-text">1.1 日志文件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B0%83%E8%AF%95%E6%97%A5%E5%BF%97"><span class="nav-text">1.1.1 调试日志</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B3%BB%E7%BB%9F%E6%97%A5%E5%BF%97"><span class="nav-text">1.1.2 系统日志</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#java%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6"><span class="nav-text">2. JAVA日志框架</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6%E5%8E%9F%E5%9B%A0"><span class="nav-text">2.1 使用日志框架原因</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%8E%B0%E6%9C%89%E7%9A%84%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6"><span class="nav-text">2.2 现有的日志框架</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#jul-%E5%AD%A6%E4%B9%A0"><span class="nav-text">3. JUL 学习</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#jul%E5%85%A5%E9%97%A8"><span class="nav-text">3.1 JUL入门</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9E%B6%E6%9E%84%E4%BB%8B%E7%BB%8D"><span class="nav-text">3.1.1 架构介绍</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%A5%E9%97%A8%E6%A1%88%E4%BE%8B"><span class="nav-text">3.1.2 入门案例</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%A5%E5%BF%97%E7%9A%84%E7%BA%A7%E5%88%AB"><span class="nav-text">3.2 日志的级别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#logger%E4%B9%8B%E9%97%B4%E7%9A%84%E7%88%B6%E5%AD%90%E5%85%B3%E7%B3%BB"><span class="nav-text">3.3 Logger之间的父子关系</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%A5%E5%BF%97%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-text">3.4 日志的配置文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%A5%E5%BF%97%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90"><span class="nav-text">3.5 日志原理解析</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#log4j-%E5%AD%A6%E4%B9%A0"><span class="nav-text">4. LOG4J 学习</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#log4j%E5%85%A5%E9%97%A8"><span class="nav-text">4.1 Log4j入门</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#log4j%E7%BB%84%E4%BB%B6"><span class="nav-text">4.2 Log4j组件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#loggers"><span class="nav-text">4.2.1 Loggers</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#appenders"><span class="nav-text">4.2.2 Appenders</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#layouts"><span class="nav-text">4.2.3 Layouts</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#layout%E7%9A%84%E6%A0%BC%E5%BC%8F"><span class="nav-text">4.3 Layout的格式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#appender%E7%9A%84%E8%BE%93%E5%87%BA"><span class="nav-text">4.4 Appender的输出</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#appender%E8%BE%93%E5%87%BA%E5%88%B0%E6%8E%A7%E5%88%B6%E5%8F%B0"><span class="nav-text">4.4.1 Appender输出到控制台</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#appender%E8%BE%93%E5%87%BA%E5%88%B0%E6%96%87%E4%BB%B6%E4%B8%AD"><span class="nav-text">4.4.2 Appender输出到文件中</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#appender%E8%BE%93%E5%87%BA%E5%88%B0%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD"><span class="nav-text">4.4.3 Appender输出到数据库中</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89logger"><span class="nav-text">4.5 自定义Logger</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#jcl-%E5%AD%A6%E4%B9%A0"><span class="nav-text">5. JCL 学习</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#jcl%E5%85%A5%E9%97%A8"><span class="nav-text">5.1 JCL入门</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#jcl%E5%8E%9F%E7%90%86"><span class="nav-text">5.2 JCL原理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%97%A5%E5%BF%97%E9%97%A8%E9%9D%A2"><span class="nav-text">6. 日志门面</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#slf4j%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-text">7. SLF4J的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#slf4j%E5%85%A5%E9%97%A8"><span class="nav-text">7.1 SLF4J入门</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%91%E5%AE%9A%E6%97%A5%E5%BF%97%E7%9A%84%E5%AE%9E%E7%8E%B0binding"><span class="nav-text">7.2 绑定日志的实现(Binding)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A1%A5%E6%8E%A5%E6%97%A7%E7%9A%84%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6bridging"><span class="nav-text">7.3 桥接旧的日志框架(Bridging)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#slf4j%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90"><span class="nav-text">7.4 SLF4J原理解析</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#logback%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-text">8. Logback的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#logback%E5%85%A5%E9%97%A8"><span class="nav-text">8.1 logback入门</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#logback%E9%85%8D%E7%BD%AE"><span class="nav-text">8.2 logback配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#logback-access%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-text">8.3 logback-access的使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#log4j2%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-text">9. log4j2的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#log4j2%E5%85%A5%E9%97%A8"><span class="nav-text">9.1 Log4j2入门</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#log4j2%E9%85%8D%E7%BD%AE"><span class="nav-text">9.2 Log4j2配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#log4j2%E5%BC%82%E6%AD%A5%E6%97%A5%E5%BF%97"><span class="nav-text">9.3 Log4j2异步日志</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#log4j2%E7%9A%84%E6%80%A7%E8%83%BD"><span class="nav-text">9.4 Log4j2的性能</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#springboot%E4%B8%AD%E7%9A%84%E6%97%A5%E5%BF%97%E4%BD%BF%E7%94%A8"><span class="nav-text">10. SpringBoot中的日志使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#springboot%E4%B8%AD%E7%9A%84%E6%97%A5%E5%BF%97%E8%AE%BE%E8%AE%A1"><span class="nav-text">10.1 SpringBoot中的日志设计</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#springboot%E6%97%A5%E5%BF%97%E4%BD%BF%E7%94%A8"><span class="nav-text">10.2 SpringBoot日志使用</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="ZhuCC"
      src="/images/%E5%A4%B4%E5%83%8F.jpg">
  <p class="site-author-name" itemprop="name">ZhuCC</p>
  <div class="site-description" itemprop="description">不急不躁。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">203</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">96</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
	  
	  
        <script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
        <script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
        <div class="widget-wrap">
            <div id="myCanvasContainer" class="widget tagcloud">
                <canvas width="250" height="250" id="resCanvas" style="width=100%">
                    <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Anaconda/" rel="tag">Anaconda</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Arthas/" rel="tag">Arthas</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/" rel="tag">C++</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CAT/" rel="tag">CAT</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Chrome/" rel="tag">Chrome</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CompletableFuture/" rel="tag">CompletableFuture</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ELK/" rel="tag">ELK</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Elasticsearch/" rel="tag">Elasticsearch</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Elasticsearck/" rel="tag">Elasticsearck</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GPU/" rel="tag">GPU</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/" rel="tag">Git</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GitHub/" rel="tag">GitHub</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Gitee/" rel="tag">Gitee</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP/" rel="tag">HTTP</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/" rel="tag">Hexo</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IO/" rel="tag">IO</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JDBC/" rel="tag">JDBC</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JDK/" rel="tag">JDK</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JVM/" rel="tag">JVM</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a><span class="tag-list-count">74</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java%E5%9F%BA%E7%A1%80/" rel="tag">Java基础</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java%E8%AF%AD%E6%B3%95/" rel="tag">Java语法</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/K%E8%BF%91%E9%82%BB/" rel="tag">K近邻</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LeetCode/" rel="tag">LeetCode</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Markdown/" rel="tag">Markdown</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mock/" rel="tag">Mock</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mockito/" rel="tag">Mockito</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MyBatis/" rel="tag">MyBatis</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/" rel="tag">MySQL</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OSS/" rel="tag">OSS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OpenCV/" rel="tag">OpenCV</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Pytorch/" rel="tag">Pytorch</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RabbitMQ/" rel="tag">RabbitMQ</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis/" rel="tag">Redis</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SSM/" rel="tag">SSM</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring/" rel="tag">Spring</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringBoot/" rel="tag">SpringBoot</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringMVC/" rel="tag">SpringMVC</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TCP-IP/" rel="tag">TCP/IP</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TensorFlow/" rel="tag">TensorFlow</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ThreadLocal/" rel="tag">ThreadLocal</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TortoiseGit/" rel="tag">TortoiseGit</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TransmittableThreadLocal/" rel="tag">TransmittableThreadLocal</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Typora/" rel="tag">Typora</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ubuntu/" rel="tag">Ubuntu</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nvidia/" rel="tag">nvidia</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%AA%E4%BA%BA%E7%BB%8F%E5%8E%86/" rel="tag">个人经历</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/" rel="tag">中间件</a><span class="tag-list-count">20</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%A8%E6%96%87%E6%A3%80%E7%B4%A2/" rel="tag">全文检索</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%86%B3%E7%AD%96%E6%A0%91/" rel="tag">决策树</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%86%E7%B1%BB%E9%97%AE%E9%A2%98/" rel="tag">分类问题</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%B7%E9%A2%98/" rel="tag">刷题</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/" rel="tag">刷题笔记</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8A%A0%E5%AF%86%E6%96%87%E7%AB%A0/" rel="tag">加密文章</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/" rel="tag">博客搭建</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8F%82%E8%80%83%E6%96%87%E4%BB%B6/" rel="tag">参考文件</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" rel="tag">基础知识</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="tag">学习笔记</a><span class="tag-list-count">104</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" rel="tag">并发编程</a><span class="tag-list-count">26</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6/" rel="tag">开发框架</a><span class="tag-list-count">31</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%88%90%E9%95%BF%E5%8F%B2/" rel="tag">成长史</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8C%81%E4%B9%85%E5%B1%82%E6%A1%86%E6%9E%B6/" rel="tag">持久层框架</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/" rel="tag">排序算法</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" rel="tag">操作系统</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA/" rel="tag">支持向量机</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6%E6%8E%A8%E5%AF%BC/" rel="tag">数学推导</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a><span class="tag-list-count">20</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97/" rel="tag">数据清洗</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag">数据结构</a><span class="tag-list-count">22</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%97%A5%E5%B8%B8/" rel="tag">日常</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%97%A5%E5%BF%97%E6%A1%86%E6%9E%B6/" rel="tag">日志框架</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" rel="tag">机器学习</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A0%91%E7%BB%93%E6%9E%84/" rel="tag">树结构</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/" rel="tag">树莓派</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7/" rel="tag">测试工具</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97/" rel="tag">消息队列</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" rel="tag">深度学习</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%89%B9%E5%BE%81%E9%80%89%E6%8B%A9/" rel="tag">特征选择</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/" rel="tag">环境配置</a><span class="tag-list-count">16</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%9B%AE%E6%A0%87%E6%A3%80%E6%B5%8B/" rel="tag">目标检测</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/" rel="tag">线性回归</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%81%9A%E7%B1%BB/" rel="tag">聚类</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%A1%A8%E7%A4%BA%E5%B1%82/" rel="tag">表示层</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E8%B7%AF/" rel="tag">计算机网路</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" rel="tag">读书笔记</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B0%83%E7%94%A8%E9%93%BE%E7%9B%91%E6%8E%A7/" rel="tag">调用链监控</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%B4%9D%E5%8F%B6%E6%96%AF/" rel="tag">贝叶斯</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BD%AF%E4%BB%B6%E4%BD%BF%E7%94%A8/" rel="tag">软件使用</a><span class="tag-list-count">16</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92/" rel="tag">逻辑回归</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9B%86%E5%90%88%E7%B1%BB/" rel="tag">集合类</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9B%86%E6%88%90%E5%AD%A6%E4%B9%A0/" rel="tag">集成学习</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%A2%E7%BB%8F/" rel="tag">面经</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/" rel="tag">面试笔记</a><span class="tag-list-count">61</span></li></ul>
                </canvas>
            </div>
        </div>
      

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ZhuCC</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">3.6m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">54:33</span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>
-->

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : '3it0tVBbppFeFBVa8QgB3vxM-gzGzoHsz',
      appKey     : '9VtnMWSrhAtC1pSRaA4Rivx9',
      placeholder: "请多多指教~",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"superSample":2,"width":150,"height":300,"position":"right","hOffset":0,"vOffset":-20},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.8},"log":false});</script></body>
</html>
